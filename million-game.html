<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø³Ø± - Ù…Ù† Ø³ÙŠØ±Ø¨Ø­ Ø§Ù„Ù…Ù„ÙŠÙˆÙ†</title>
    <style>
        /* ØªÙŠÙ…Ø¨Ù„Øª Color Hunt: #BFC6C4 #E8E2D8 #6F8F72 #F2A65A */
        :root {
            --palette-gray: #BFC6C4;
            --palette-cream: #E8E2D8;
            --palette-sage: #6F8F72;
            --palette-orange: #F2A65A;
            --palette-sage-dark: #5a7560;
            --palette-orange-dark: #d99245;
            --text-dark: #2d3436;
            --text-muted: #636e72;
        }

        body {
            margin: 0;
            font-family: "Tajawal", "Cairo", "Tahoma", Arial, sans-serif;
            background: var(--palette-cream);
            color: var(--text-dark);
            min-height: 100vh;
            line-height: 1.5;
        }

        header {
            text-align: center;
            padding: 22px 16px;
            background: linear-gradient(135deg, var(--palette-sage) 0%, var(--palette-sage-dark) 100%);
            border-bottom: 3px solid var(--palette-orange);
            position: sticky;
            top: 0;
            z-index: 10;
            box-shadow: 0 4px 16px rgba(111, 143, 114, 0.25);
        }

        #gameTitle {
            font-size: 24px;
            font-weight: bold;
            color: #fff;
            outline: none;
            cursor: text;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        header small {
            display: block;
            font-size: 12px;
            color: rgba(255,255,255,0.85);
            margin-top: 6px;
        }

        .container {
            width: 95%;
            max-width: 1200px;
            margin: 20px auto 40px auto;
        }

        section {
            background: #fff;
            border-radius: 14px;
            padding: 18px 20px;
            margin-bottom: 18px;
            border: 1px solid var(--palette-gray);
            box-shadow: 0 2px 12px rgba(191, 198, 196, 0.35);
            transition: box-shadow 0.2s ease;
        }

        section:hover {
            box-shadow: 0 4px 20px rgba(111, 143, 114, 0.12);
        }

        h2 {
            margin-top: 0;
            margin-bottom: 12px;
            color: var(--palette-sage);
            font-size: 18px;
            font-weight: 700;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--palette-cream);
        }

        input,
        select,
        button {
            padding: 9px 12px;
            margin: 5px;
            border-radius: 8px;
            border: 1px solid var(--palette-gray);
            font-family: inherit;
            font-size: 14px;
        }

        input,
        select {
            background: #fff;
            color: var(--text-dark);
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--palette-sage);
            box-shadow: 0 0 0 2px rgba(111, 143, 114, 0.2);
        }

        input::placeholder {
            color: var(--text-muted);
        }

        button {
            cursor: pointer;
            border: none;
            color: #fff;
            font-weight: bold;
            transition: transform 0.12s ease, box-shadow 0.2s ease, opacity 0.15s ease;
        }

        button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        button:active {
            transform: scale(0.98);
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        }

        .btn-main {
            background: linear-gradient(135deg, var(--palette-orange), var(--palette-orange-dark));
        }

        .btn-green {
            background: linear-gradient(135deg, var(--palette-sage), var(--palette-sage-dark));
        }

        .btn-red {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .btn-blue {
            background: linear-gradient(135deg, #6b8cae, #5a7a99);
        }

        .btn-purple {
            background: linear-gradient(135deg, #8e7ba6, #7a6a8f);
        }

        .btn-dark {
            background: linear-gradient(135deg, var(--palette-gray), #9ca5a2);
            color: var(--text-dark);
        }

        .flex-row {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
        }

        .flex-row>* {
            margin-bottom: 5px;
        }

        .families-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .family-card {
            background: #fff;
            border-radius: 14px;
            padding: 14px;
            width: 220px;
            border: 2px solid var(--palette-gray);
            box-shadow: 0 2px 12px rgba(191, 198, 196, 0.4);
            position: relative;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        .family-card:hover {
            border-color: var(--palette-sage);
            box-shadow: 0 4px 16px rgba(111, 143, 114, 0.2);
        }

        .family-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--palette-cream);
        }

        .family-name {
            font-weight: bold;
            font-size: 16px;
            color: var(--palette-sage);
        }

        .family-rank {
            font-size: 11px;
            color: var(--text-muted);
            background: var(--palette-cream);
            padding: 2px 8px;
            border-radius: 20px;
        }

        .points-row {
            font-size: 13px;
            margin: 4px 0;
        }

        .label {
            color: var(--text-muted);
        }

        .value {
            font-weight: bold;
            color: var(--text-dark);
        }

        .family-buttons {
            margin-top: 10px;
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            justify-content: center;
        }

        .family-buttons button {
            font-size: 11px;
            padding: 5px 8px;
        }

        .leader {
            border-color: var(--palette-sage);
            box-shadow: 0 4px 20px rgba(111, 143, 114, 0.3);
        }

        .history-box {
            max-height: 220px;
            overflow-y: auto;
            background: var(--palette-cream);
            padding: 10px;
            border-radius: 10px;
            font-size: 13px;
            border: 1px solid var(--palette-gray);
        }

        .history-entry {
            margin-bottom: 6px;
            border-bottom: 1px dashed var(--palette-gray);
            padding-bottom: 5px;
        }

        .history-entry span.time {
            color: var(--text-muted);
            font-size: 11px;
            margin-right: 4px;
        }

        .top-bar {
            font-size: 14px;
            margin-bottom: 10px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .top-pill {
            background: var(--palette-cream);
            border-radius: 999px;
            padding: 6px 12px;
            border: 1px solid var(--palette-gray);
            color: var(--text-dark);
        }

        /* Ø£ÙˆÙØ±Ù„Ø§ÙŠ Ø§Ù„Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ…Ø² */
        .overlay {
            position: fixed;
            inset: 0;
            background: rgba(45, 52, 54, 0.75);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
            backdrop-filter: blur(4px);
        }

        .hidden {
            display: none;
        }

        .mini-panel {
            background: #fff;
            border-radius: 16px;
            padding: 20px;
            width: 95%;
            max-width: 800px;
            max-height: 90vh;
            border: 2px solid var(--palette-sage);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
        }

        .mini-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--palette-cream);
        }

        .mini-title {
            font-size: 18px;
            color: var(--palette-sage);
            font-weight: 700;
        }

        .mini-body {
            flex: 1;
            overflow-y: auto;
            background: var(--palette-cream);
            border-radius: 12px;
            padding: 14px;
            font-size: 14px;
            color: var(--text-dark);
            border: 1px solid var(--palette-gray);
        }

        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ù„Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ */
        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 60px);
            gap: 8px;
            justify-content: center;
            margin-top: 10px;
        }

        .memory-card {
            width: 60px;
            height: 60px;
            background: var(--palette-gray);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 26px;
            cursor: pointer;
            user-select: none;
            border: 2px solid var(--palette-cream);
        }

        .memory-card.flipped {
            background: var(--palette-orange);
            color: #fff;
        }

        .memory-card.matched {
            background: var(--palette-sage);
            color: #fff;
            cursor: default;
        }

        .reaction-box {
            text-align: center;
            padding: 15px;
        }

        .reaction-area {
            margin-top: 15px;
            padding: 25px;
            border-radius: 12px;
            background: var(--palette-sage);
            color: #fff;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        .reaction-area:hover {
            opacity: 0.9;
        }

        .mole-grid {
            display: grid;
            grid-template-columns: repeat(3, 70px);
            gap: 8px;
            justify-content: center;
            margin-top: 10px;
        }

        .mole-cell {
            width: 70px;
            height: 70px;
            background: var(--palette-gray);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            user-select: none;
            font-size: 26px;
            border: 2px solid var(--palette-cream);
        }

        .mole-cell.mole {
            background: var(--palette-sage);
            color: #fff;
        }

        .color-grid {
            display: grid;
            grid-template-columns: repeat(4, 40px);
            gap: 6px;
            justify-content: center;
            margin-top: 10px;
        }

        .color-cell {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid var(--palette-gray);
        }

        .cup-row {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }

        .cup {
            width: 60px;
            height: 70px;
            border-radius: 10px;
            background: var(--palette-cream);
            border: 2px solid var(--palette-sage);
            color: var(--palette-sage);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            font-size: 22px;
        }

        .typing-box textarea {
            width: 100%;
            min-height: 80px;
            margin-top: 8px;
            background: #fff;
            color: var(--text-dark);
            border-radius: 10px;
            padding: 10px;
            border: 1px solid var(--palette-gray);
        }

        .typing-box textarea:focus {
            outline: none;
            border-color: var(--palette-sage);
            box-shadow: 0 0 0 2px rgba(111, 143, 114, 0.2);
        }

        @media (max-width: 600px) {
            .family-card {
                width: 100%;
            }
        }

        .credit-footer {
            text-align: center;
            padding: 18px 12px;
            margin-top: 24px;
            display: flex;
            flex-direction: column;
            gap: 4px;
            font-size: 12px;
            color: var(--palette-sage);
            opacity: 0.9;
        }
        .credit-footer .credit-by { font-weight: 600; }
        .credit-footer .credit-rights { font-size: 11px; color: var(--text-muted); }
    </style>
</head>

<body>

    <header>
        <div id="gameTitle" contenteditable="true">
            Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø³Ø± - Ù…Ù† Ø³ÙŠØ±Ø¨Ø­ Ø§Ù„Ù…Ù„ÙŠÙˆÙ†
        </div>
        <small>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù„ØªØºÙŠÙŠØ± Ø§Ø³Ù… Ø§Ù„Ù„Ø¹Ø¨Ø©</small>
    </header>

    <div class="container">

        <!-- Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø³Ø± -->
        <section>
            <h2>Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø³Ø±</h2>
            <div class="flex-row">
                <input id="familyNameInput" type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ø£Ø³Ø±Ø©">
                <input id="startPointsInput" type="number" placeholder="Ù†Ù‚Ø§Ø· Ø¨Ø¯Ø§ÙŠØ© (Ù…Ø«Ù„Ø§Ù‹ 0)">
                <button class="btn-main" onclick="addFamily()">Ø¥Ø¶Ø§ÙØ© Ø£Ø³Ø±Ø©</button>
            </div>

            <div class="flex-row" style="margin-top:8px;">
                <input id="autoCountInput" type="number" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø± (Ù„Ø¥Ù†Ø´Ø§Ø¡ ØªÙ„Ù‚Ø§Ø¦ÙŠ)">
                <button class="btn-blue" onclick="createAutoFamilies()">Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø³Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ (Ø£Ø³Ø±Ø© 1ØŒ Ø£Ø³Ø±Ø© 2 ...)</button>
                <button class="btn-red" onclick="resetAllFamilies()">Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· ÙƒÙ„ Ø§Ù„Ø£Ø³Ø±</button>
            </div>
        </section>

        <!-- Ù…Ù„Ø®Øµ Ø£Ø¹Ù„Ù‰ -->
        <section>
            <h2>Ù…Ù„Ø®Øµ Ø³Ø±ÙŠØ¹</h2>
            <div class="top-bar" id="summaryBar"></div>
        </section>

        <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø³Ø± -->
        <section>
            <h2>Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø³Ø±</h2>
            <div class="families-grid" id="familiesGrid"></div>
        </section>

        <!-- Ø§Ù„Ø¨ÙŠÙ†ÙŠØ§Øª ÙˆØ§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø§Ø· -->
        <section>
            <h2>Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø§Ø·</h2>

            <div class="flex-row">
                <select id="targetFamilySelect1"></select>
                <button class="btn-red" onclick="zeroWallet()">ØªØµÙÙŠØ± Ø£Ø³Ø±Ø© (Ø§Ù„Ù…Ø­ÙØ¸Ø© ÙÙ‚Ø·)</button>

                <select id="targetFamilySelect2"></select>
                <button class="btn-dark" onclick="zeroAll()">ØªØµÙÙŠØ± Ø£Ø³Ø±Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</button>

                <select id="targetFamilySelect3"></select>
                <button class="btn-purple" onclick="quadrupleWallet()">ØªØ¶Ø¹ÙŠÙ Ã—4 (Ø§Ù„Ù…Ø­ÙØ¸Ø©)</button>
            </div>

            <div class="flex-row" style="margin-top:8px;">
                <select id="fromFamilySelect"></select>
                <select id="toFamilySelect"></select>
                <input id="transferAmountInput" type="number" placeholder="ÙƒÙ… Ù†Ù‚Ø·Ø© ØªÙ†Ù‚Ù„ØŸ">
                <button class="btn-blue" onclick="transferPoints()">Ù†Ù‚Ù„ / Ø³Ø±Ù‚Ø© Ù†Ù‚Ø§Ø· Ø¨ÙŠÙ† Ø§Ù„Ø£Ø³Ø±</button>
            </div>

            <div class="flex-row" style="margin-top:8px;">
                <select id="bankFamilySelect"></select>
                <button class="btn-green" onclick="depositAllToBank()">Ø¥ÙŠØ¯Ø§Ø¹ ÙƒÙ„ Ø§Ù„Ù…Ø­ÙØ¸Ø© ÙÙŠ Ø§Ù„Ø¨Ù†Ùƒ</button>
            </div>
        </section>

        <!-- Ø§Ù„Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ…Ø² (Ø§Ù„Ø¨ÙŠÙ†ÙŠØ§Øª Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©) -->
        <section>
            <h2>Ø§Ù„Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ…Ø² (Ø§Ù„Ø¨ÙŠÙ†ÙŠØ§Øª)</h2>
            <div class="flex-row">
                <select id="miniGameSelect"></select>
                <button class="btn-main" onclick="startSelectedMiniGame()">ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ… Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©</button>
                <button class="btn-blue" onclick="startRandomMiniGame()">Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ… Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© ğŸ®</button>
            </div>
            <small style="color:var(--text-muted, #636e72);">
                Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ…ØŒ Ø§Ø®ØªØ± Ø§Ù„Ø£Ø³Ø±Ø© Ø§Ù„ÙØ§Ø¦Ø²Ø© Ù…Ù† Ø§Ù„ÙƒØ±ÙˆØª Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰ ÙˆØ¹Ø¯Ù‘Ù„ Ù†Ù‚Ø§Ø·Ù‡Ø§ ÙŠØ¯ÙˆÙŠÙ‹Ø§.
            </small>
        </section>

        <!-- Ø§Ù„Ø³Ø¬Ù„ -->
        <section>
            <h2>Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«</h2>
            <div class="history-box" id="historyBox"></div>
        </section>

    </div>

    <!-- Ø£ÙˆÙØ±Ù„Ø§ÙŠ Ø§Ù„Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ…Ø² -->
    <div id="miniGameOverlay" class="overlay hidden">
        <div class="mini-panel">
            <div class="mini-header">
                <div id="miniGameTitle" class="mini-title">Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ…</div>
                <div>
                    <button class="btn-dark" onclick="closeMiniGame()">Ø¥ØºÙ„Ø§Ù‚ Ã—</button>
                </div>
            </div>
            <div id="miniGameBody" class="mini-body">
                <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ… ÙŠØªÙ… Ø­Ù‚Ù†Ù‡ Ù‡Ù†Ø§ -->
            </div>
        </div>
    </div>

    <script>
        // =====================================
        // Ù†Ù…ÙˆØ°Ø¬ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø±
        // =====================================
        let families = [];
        let familyIdCounter = 1;

        function addFamily() {
            const nameInput = document.getElementById('familyNameInput');
            const startPointsInput = document.getElementById('startPointsInput');

            let name = nameInput.value.trim();
            let startPoints = Number(startPointsInput.value);

            if (!name) {
                alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø£Ø³Ø±Ø©");
                return;
            }
            if (isNaN(startPoints)) startPoints = 0;

            families.push({
                id: familyIdCounter++,
                name: name,
                wallet: startPoints,
                bank: 0
            });

            nameInput.value = "";
            startPointsInput.value = "";
            renderAll();
            log(`ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø³Ø±Ø© Â«${name}Â» Ø¨Ø±ØµÙŠØ¯ Ø¨Ø¯Ø§ÙŠØ© ${startPoints} Ù†Ù‚Ø·Ø©`);
        }

        function createAutoFamilies() {
            const countInput = document.getElementById('autoCountInput');
            const count = Number(countInput.value);

            if (!count || count <= 0) {
                alert("Ø£Ø¯Ø®Ù„ Ø¹Ø¯Ø¯ Ø£Ø³Ø± ØµØ­ÙŠØ­");
                return;
            }

            families = [];
            familyIdCounter = 1;

            for (let i = 1; i <= count; i++) {
                families.push({
                    id: familyIdCounter++,
                    name: "Ø£Ø³Ø±Ø© " + i,
                    wallet: 0,
                    bank: 0
                });
            }

            countInput.value = "";
            renderAll();
            log(`ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ${count} Ø£Ø³Ø±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§`);
        }

        function resetAllFamilies() {
            if (!confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø± Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ØŸ")) return;
            families.forEach(f => {
                f.wallet = 0;
                f.bank = 0;
            });
            renderAll();
            log("ØªÙ… ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø± (Ø§Ù„Ø±ØµÙŠØ¯ ÙˆØ§Ù„Ø¨Ù†Ùƒ)");
        }

        function renderAll() {
            renderFamilies();
            renderSummary();
            renderSelects();
        }

        function renderFamilies() {
            const grid = document.getElementById('familiesGrid');
            grid.innerHTML = "";

            if (families.length === 0) {
                grid.innerHTML = "<p style='text-align:center;color:#636e72;'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ø± Ø¨Ø¹Ø¯. Ø£Ø¶Ù Ø£Ø³Ø±Ø© Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰.</p>";
                return;
            }

            const leaderId = getLeaderId();

            families.forEach((f, index) => {
                const total = f.wallet + f.bank;

                const card = document.createElement('div');
                card.className = "family-card" + (f.id === leaderId ? " leader" : "");

                card.innerHTML = `
                <div class="family-header">
                    <div class="family-name">${f.name}</div>
                    <div class="family-rank">#${index + 1}</div>
                </div>
                <div class="points-row">
                    <span class="label">Ø§Ù„Ù…Ø­ÙØ¸Ø©:</span>
                    <span class="value">${f.wallet}</span>
                </div>
                <div class="points-row">
                    <span class="label">Ø§Ù„Ø¨Ù†Ùƒ:</span>
                    <span class="value">${f.bank}</span>
                </div>
                <div class="points-row">
                    <span class="label">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span>
                    <span class="value">${total}</span>
                </div>
                <div class="family-buttons">
                    <button class="btn-green" onclick="doubleWallet(${f.id})">Ã—2</button>
                    <button class="btn-purple" onclick="addToWallet(${f.id}, 100)">+100</button>
                    <button class="btn-dark" onclick="addToWallet(${f.id}, -100)">-100</button>
                    <button class="btn-main" onclick="editFamilyName(${f.id})">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù…</button>
                    <button class="btn-red" onclick="deleteFamily(${f.id})">Ø­Ø°Ù Ø§Ù„Ø£Ø³Ø±Ø©</button>
                </div>
            `;

                grid.appendChild(card);
            });
        }

        function renderSummary() {
            const bar = document.getElementById('summaryBar');
            bar.innerHTML = "";

            const familiesCount = families.length;
            const totalPoints = families.reduce((sum, f) => sum + f.wallet + f.bank, 0);
            const leader = getLeader();

            const pill1 = document.createElement('div');
            pill1.className = "top-pill";
            pill1.textContent = `Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø±: ${familiesCount}`;
            bar.appendChild(pill1);

            const pill2 = document.createElement('div');
            pill2.className = "top-pill";
            pill2.textContent = `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‚Ø§Ø· ÙÙŠ Ø§Ù„Ù„Ø¹Ø¨Ø©: ${totalPoints}`;
            bar.appendChild(pill2);

            if (leader) {
                const pill3 = document.createElement('div');
                pill3.className = "top-pill";
                pill3.textContent = `Ø§Ù„Ù…ØªØµØ¯Ø±: ${leader.name} (${leader.wallet + leader.bank} Ù†Ù‚Ø·Ø©)`;
                bar.appendChild(pill3);
            }
        }

        function renderSelects() {
            const selectsIds = [
                'targetFamilySelect1',
                'targetFamilySelect2',
                'targetFamilySelect3',
                'fromFamilySelect',
                'toFamilySelect',
                'bankFamilySelect'
            ];
            selectsIds.forEach(id => {
                const sel = document.getElementById(id);
                sel.innerHTML = "";
                families.forEach(f => {
                    const opt = document.createElement('option');
                    opt.value = f.id;
                    opt.textContent = f.name;
                    sel.appendChild(opt);
                });
            });
        }

        function getLeader() {
            if (families.length === 0) return null;
            let sorted = [...families].sort((a, b) => (b.wallet + b.bank) - (a.wallet + a.bank));
            return sorted[0];
        }
        function getLeaderId() {
            const leader = getLeader();
            return leader ? leader.id : null;
        }

        function findFamily(id) {
            return families.find(f => f.id === id);
        }

        function addToWallet(id, amount) {
            const f = findFamily(id);
            if (!f) return;
            let newVal = f.wallet + amount;
            if (newVal < 0) newVal = 0;
            f.wallet = newVal;
            renderAll();
            if (amount > 0) {
                log(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${amount} Ù†Ù‚Ø·Ø© Ø¥Ù„Ù‰ Â«${f.name}Â» (Ø§Ù„Ù…Ø­ÙØ¸Ø©)`);
            } else if (amount < 0) {
                log(`ØªÙ… Ø®ØµÙ… ${Math.abs(amount)} Ù†Ù‚Ø·Ø© Ù…Ù† Â«${f.name}Â» (Ø§Ù„Ù…Ø­ÙØ¸Ø©)`);
            }
        }

        function doubleWallet(id) {
            const f = findFamily(id);
            if (!f) return;
            f.wallet = f.wallet * 2;
            renderAll();
            log(`ØªÙ… ØªØ¶Ø¹ÙŠÙ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø£Ø³Ø±Ø© Â«${f.name}Â» Ø¥Ù„Ù‰ ${f.wallet} Ù†Ù‚Ø·Ø© (Ã—2)`);
        }

        function editFamilyName(id) {
            const f = findFamily(id);
            if (!f) return;
            const newName = prompt("Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø£Ø³Ø±Ø©:", f.name);
            if (newName && newName.trim()) {
                log(`ØªÙ… ØªØºÙŠÙŠØ± Ø§Ø³Ù… Ø§Ù„Ø£Ø³Ø±Ø© Ù…Ù† Â«${f.name}Â» Ø¥Ù„Ù‰ Â«${newName.trim()}Â»`);
                f.name = newName.trim();
                renderAll();
            }
        }

        function deleteFamily(id) {
            const f = findFamily(id);
            if (!f) return;
            if (!confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ø£Ø³Ø±Ø© Â«${f.name}Â»ØŸ`)) return;
            families = families.filter(x => x.id !== id);
            renderAll();
            log(`ØªÙ… Ø­Ø°Ù Ø§Ù„Ø£Ø³Ø±Ø© Â«${f.name}Â» Ù…Ù† Ø§Ù„Ù„Ø¹Ø¨Ø©`);
        }

        function zeroWallet() {
            const sel = document.getElementById('targetFamilySelect1');
            const id = Number(sel.value);
            const f = findFamily(id);
            if (!f) return;
            if (!confirm(`ØªØ£ÙƒÙŠØ¯: ØªØµÙÙŠØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© ÙÙ‚Ø· Ù„Ù„Ø£Ø³Ø±Ø© Â«${f.name}Â»ØŸ`)) return;
            f.wallet = 0;
            renderAll();
            log(`Ø¨ÙŠÙ†ÙŠØ©: ØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø£Ø³Ø±Ø© Â«${f.name}Â»`);
        }

        function zeroAll() {
            const sel = document.getElementById('targetFamilySelect2');
            const id = Number(sel.value);
            const f = findFamily(id);
            if (!f) return;
            if (!confirm(`ØªØ£ÙƒÙŠØ¯: ØªØµÙÙŠØ± Ø§Ù„Ø£Ø³Ø±Ø© Â«${f.name}Â» Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ (Ù…Ø­ÙØ¸Ø© + Ø¨Ù†Ùƒ)ØŸ`)) return;
            f.wallet = 0;
            f.bank = 0;
            renderAll();
            log(`Ø¨ÙŠÙ†ÙŠØ© Ù‚ÙˆÙŠØ©: ØªÙ… ØªØµÙÙŠØ± Â«${f.name}Â» Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ ğŸ˜±`);
        }

        function quadrupleWallet() {
            const sel = document.getElementById('targetFamilySelect3');
            const id = Number(sel.value);
            const f = findFamily(id);
            if (!f) return;
            if (!confirm(`ØªØ£ÙƒÙŠØ¯: ØªØ¶Ø¹ÙŠÙ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø£Ø³Ø±Ø© Â«${f.name}Â» Ø£Ø±Ø¨Ø¹ Ù…Ø±Ø§ØªØŸ (Ã—4)`)) return;
            f.wallet = f.wallet * 4;
            renderAll();
            log(`Ø¨ÙŠÙ†ÙŠØ© Ø­Ù…Ø§Ø³ÙŠØ©: ØªÙ… ØªØ¶Ø¹ÙŠÙ Ù…Ø­ÙØ¸Ø© Â«${f.name}Â» Ã—4 Ù„ØªØµØ¨Ø­ ${f.wallet} Ù†Ù‚Ø·Ø© ğŸ”¥`);
        }

        function transferPoints() {
            const fromSel = document.getElementById('fromFamilySelect');
            const toSel = document.getElementById('toFamilySelect');
            const amountInput = document.getElementById('transferAmountInput');

            const fromId = Number(fromSel.value);
            const toId = Number(toSel.value);
            let amount = Number(amountInput.value);

            if (!fromId || !toId || fromId === toId) {
                alert("Ø§Ø®ØªØ± Ø£Ø³Ø±Ø© Ù…Ø±Ø³Ù„Ø© ÙˆØ£Ø®Ø±Ù‰ Ù…Ø³ØªÙ‚Ø¨Ù„Ø© (Ù…Ø®ØªÙ„ÙØªÙŠÙ†)");
                return;
            }
            if (!amount || amount <= 0) {
                alert("Ø£Ø¯Ø®Ù„ Ù‚ÙŠÙ…Ø© Ù†Ù‚Ø§Ø· ØµØ­ÙŠØ­Ø© Ù„Ù„Ù†Ù‚Ù„");
                return;
            }

            const fromFam = findFamily(fromId);
            const toFam = findFamily(toId);
            if (!fromFam || !toFam) return;

            if (fromFam.wallet < amount) {
                amount = fromFam.wallet;
            }

            fromFam.wallet -= amount;
            toFam.wallet += amount;

            renderAll();
            log(`Ø¨ÙŠÙ†ÙŠØ©: ØªÙ… Ù†Ù‚Ù„ ${amount} Ù†Ù‚Ø·Ø© Ù…Ù† Â«${fromFam.name}Â» Ø¥Ù„Ù‰ Â«${toFam.name}Â» (Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø© ÙÙ‚Ø·)`);
            amountInput.value = "";
        }

        function depositAllToBank() {
            const sel = document.getElementById('bankFamilySelect');
            const id = Number(sel.value);
            const f = findFamily(id);
            if (!f) return;
            if (f.wallet <= 0) {
                alert("Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø³Ø±Ø© Ù„Ø§ ØªÙ…Ù„Ùƒ Ø±ØµÙŠØ¯Ù‹Ø§ ÙÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ø¥ÙŠØ¯Ø§Ø¹Ù‡");
                return;
            }
            const amt = f.wallet;
            f.wallet = 0;
            f.bank += amt;
            renderAll();
            log(`ØªÙ… Ø¥ÙŠØ¯Ø§Ø¹ ÙƒÙ„ Ø§Ù„Ù…Ø­ÙØ¸Ø© (${amt} Ù†Ù‚Ø·Ø©) ÙÙŠ Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø±Ø© Â«${f.name}Â»`);
        }

        // =====================================
        // Ø§Ù„Ø³Ø¬Ù„
        // =====================================
        function log(text) {
            const box = document.getElementById('historyBox');
            const entry = document.createElement('div');
            entry.className = "history-entry";

            const timeSpan = document.createElement('span');
            timeSpan.className = "time";
            const now = new Date();
            const hh = String(now.getHours()).padStart(2, '0');
            const mm = String(now.getMinutes()).padStart(2, '0');
            timeSpan.textContent = `[${hh}:${mm}]`;

            const msgSpan = document.createElement('span');
            msgSpan.textContent = " " + text;

            entry.appendChild(timeSpan);
            entry.appendChild(msgSpan);
            box.prepend(entry);
        }

        // =====================================
        // Ø§Ù„Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ…Ø²
        // =====================================
        const MINI_GAMES = [
            { id: "memory", label: "1- Ù„Ø¹Ø¨Ø© Ø§Ù„Ø°Ø§ÙƒØ±Ø© (ÙƒØ±ÙˆØª)" },
            { id: "reaction", label: "2- Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±Ø¹Ø© Ø§Ù„ØªÙØ§Ø¹Ù„" },
            { id: "mole", label: "3- Ø§Ø¶Ø±Ø¨ Ø§Ù„Ø®Ù„Ø¯" },
            { id: "guessNumber", label: "4- ØªØ®Ù…ÙŠÙ† Ø§Ù„Ø±Ù‚Ù… (1-100)" },
            { id: "clicker", label: "5- ØªØ­Ø¯ÙŠ Ø§Ù„Ù†Ù‚Ø± Ø§Ù„Ø³Ø±ÙŠØ¹" },
            { id: "oddColor", label: "6- Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ù…Ø®ØªÙ„Ù" },
            { id: "typing", label: "7- Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±Ø¹Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø©" },
            { id: "mentalSteps", label: "8- Ø³Ù„Ù… Ø§Ù„Ø£Ø±Ù‚Ø§Ù… (Ø¬Ù…Ø¹/Ø·Ø±Ø­ Ø°Ù‡Ù†ÙŠ)" },
            { id: "snake", label: "9- Ù„Ø¹Ø¨Ø© Ø§Ù„Ø«Ø¹Ø¨Ø§Ù†" },
            { id: "flappy", label: "10- Ù„Ø¹Ø¨Ø© Ø§Ù„Ø·Ø§Ø¦Ø± Ø§Ù„Ø·Ø§Ø¦Ø±" },
            { id: "maze", label: "11- Ø§Ù„Ù…ØªØ§Ù‡Ø©" },
            { id: "minesweeper", label: "12- ÙƒØ§Ø³Ø­ Ø§Ù„Ø£Ù„ØºØ§Ù…" },
            { id: "obstacle", label: "13- ØªØ¬Ù†Ø¨ Ø§Ù„Ø¹ÙˆØ§Ø¦Ù‚" },
            { id: "colorSequence", label: "14- ØªØªØ§Ø¨Ø¹ Ø§Ù„Ø£Ù„ÙˆØ§Ù† (Ø°Ø§ÙƒØ±Ø©)" },
            { id: "numberSequence", label: "15- ØªØªØ§Ø¨Ø¹ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… (Ø°Ø§ÙƒØ±Ø©)" },
            { id: "speedMath", label: "16- Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø±ÙŠØ¹" },
            { id: "aimTrainer", label: "17- ØªØ¯Ø±ÙŠØ¨ Ø§Ù„ØªØµÙˆÙŠØ¨" },
            { id: "rhythmTap", label: "18- Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¥ÙŠÙ‚Ø§Ø¹" },
            { id: "stackBlocks", label: "19- ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…ÙƒØ¹Ø¨Ø§Øª" },
            { id: "patternMatch", label: "20- Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ù†Ù…Ø·" },
            { id: "counting", label: "21- Ù„Ø¹Ø¨Ø© Ø§Ù„Ø¹Ø¯ Ø§Ù„Ø³Ø±ÙŠØ¹" }
        ];

        function populateMiniGameSelect() {
            const sel = document.getElementById('miniGameSelect');
            sel.innerHTML = "";
            MINI_GAMES.forEach(g => {
                const opt = document.createElement('option');
                opt.value = g.id;
                opt.textContent = g.label;
                sel.appendChild(opt);
            });
        }

        function startSelectedMiniGame() {
            const sel = document.getElementById('miniGameSelect');
            const id = sel.value;
            if (!id) {
                alert("Ø§Ø®ØªØ± Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ… Ø£ÙˆÙ„Ø§Ù‹");
                return;
            }
            openMiniGame(id);
        }

        function startRandomMiniGame() {
            const idx = Math.floor(Math.random() * MINI_GAMES.length);
            openMiniGame(MINI_GAMES[idx].id);
        }

        let currentGameId = null;
        let mazeCurrentIndex = -1;

        /** Ù‚Ø§Ø¦Ù…Ø© Ù…Ø¤Ù‚ØªØ§Øª Ø§Ù„Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ… â€” ØªÙÙ…Ø³Ø­ Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ù„ÙˆÙ‚Ù Ø§Ù„Ø¹Ø¯Ù‘ */
        let miniGameTimerIds = [];
        function registerMiniGameTimer(id) {
            if (id != null) miniGameTimerIds.push(id);
        }
        function clearAllMiniGameTimers() {
            miniGameTimerIds.forEach(function(id) {
                try { clearTimeout(id); clearInterval(id); } catch (e) {}
            });
            miniGameTimerIds.length = 0;
        }

        /** Ù„Ø§ Ù†Ø¹Ø±Ø¶ Ù†ØªÙŠØ¬Ø© Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙˆÙ‚Øª Ø¥Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£ØºÙ„Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© */
        function isMiniGameOverlayOpen() {
            var el = document.getElementById('miniGameOverlay');
            return el && !el.classList.contains('hidden');
        }

        function openMiniGame(id) {
            const overlay = document.getElementById('miniGameOverlay');
            const titleEl = document.getElementById('miniGameTitle');
            const bodyEl = document.getElementById('miniGameBody');

            const gameInfo = MINI_GAMES.find(g => g.id === id);
            titleEl.textContent = gameInfo ? gameInfo.label : "Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ…";

            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ØªØ§Ù‡Ø© Ø¥Ø°Ø§ ØªØºÙŠØ±Øª Ø§Ù„Ù„Ø¹Ø¨Ø©
            if (currentGameId !== id && currentGameId === "maze") {
                mazeCurrentIndex = -1;
            }
            currentGameId = id;

            bodyEl.innerHTML = ""; // clear

            // Ù†Ø®ØªØ§Ø± Ø§Ù„Ù„Ø¹Ø¨Ø©
            if (id === "memory") {
                initMemoryGame(bodyEl);
            } else if (id === "reaction") {
                initReactionGame(bodyEl);
            } else if (id === "mole") {
                initMoleGame(bodyEl);
            } else if (id === "guessNumber") {
                initGuessNumberGame(bodyEl);
            } else if (id === "clicker") {
                initClickerGame(bodyEl);
            } else if (id === "oddColor") {
                initOddColorGame(bodyEl);
            } else if (id === "typing") {
                initTypingGame(bodyEl);
            } else if (id === "mentalSteps") {
                initMentalStepsGame(bodyEl);
            } else if (id === "snake") {
                initSnakeGame(bodyEl);
            } else if (id === "flappy") {
                initFlappyGame(bodyEl);
            } else if (id === "maze") {
                initMazeGame(bodyEl);
            } else if (id === "minesweeper") {
                initMinesweeperGame(bodyEl);
            } else if (id === "obstacle") {
                initObstacleGame(bodyEl);
            } else if (id === "colorSequence") {
                initColorSequenceGame(bodyEl);
            } else if (id === "numberSequence") {
                initNumberSequenceGame(bodyEl);
            } else if (id === "speedMath") {
                initSpeedMathGame(bodyEl);
            } else if (id === "aimTrainer") {
                initAimTrainerGame(bodyEl);
            } else if (id === "rhythmTap") {
                initRhythmTapGame(bodyEl);
            } else if (id === "stackBlocks") {
                initStackBlocksGame(bodyEl);
            } else if (id === "patternMatch") {
                initPatternMatchGame(bodyEl);
            } else if (id === "counting") {
                initCountingGame(bodyEl);
            }

            overlay.classList.remove('hidden');
            log(`ØªÙ… ØªØ´ØºÙŠÙ„ Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ…: ${titleEl.textContent}`);
        }

        function closeMiniGame() {
            clearAllMiniGameTimers();
            const overlay = document.getElementById('miniGameOverlay');
            overlay.classList.add('hidden');
        }

        // ========== 1) Ù„Ø¹Ø¨Ø© Ø§Ù„Ø°Ø§ÙƒØ±Ø© ==========
        function initMemoryGame(container) {
            const wrapper = document.createElement('div');
            wrapper.innerHTML = `
            <div>Ø§Ø®ØªØ± Ù„Ø§Ø¹Ø¨Ù‹Ø§ Ù…Ù† ÙƒÙ„ Ø£Ø³Ø±Ø©ØŒ ÙˆØ§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ Ù…Ù† ÙŠÙØªØ­ Ø§Ù„Ø£Ø²ÙˆØ§Ø¬ ÙÙŠ Ø£Ù‚Ù„ Ø¹Ø¯Ø¯ Ù…Ø­Ø§ÙˆÙ„Ø§Øª.</div>
            <div style="margin-top:6px;">Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ ÙƒØ±ØªÙŠÙ† Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø·Ø§Ø¨Ù‚ØªÙ‡Ù…Ø§.</div>
            <div id="memoryStats" style="margin-top:6px;">Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª: 0 | Ø§Ù„Ø£Ø²ÙˆØ§Ø¬ Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©: 0 / 8</div>
        `;
            const grid = document.createElement('div');
            grid.className = "memory-grid";
            grid.style.gridTemplateColumns = "repeat(4, 60px)";

            const symbols = ['ğŸ', 'ğŸ', 'â­', 'â­', 'âš½', 'âš½', 'ğŸ§', 'ğŸ§', 'ğŸš—', 'ğŸš—', 'ğŸ®', 'ğŸ®', 'ğŸ“±', 'ğŸ“±', 'ğŸ¯', 'ğŸ¯'];
            // Ø®Ù„Ø·
            for (let i = symbols.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [symbols[i], symbols[j]] = [symbols[j], symbols[i]];
            }

            let firstIndex = null;
            let lock = false;
            let attempts = 0;
            let matched = 0;

            symbols.forEach((sym, idx) => {
                const card = document.createElement('div');
                card.className = "memory-card";
                card.dataset.index = idx;
                card.dataset.symbol = sym;
                card.textContent = "";
                card.addEventListener('click', () => {
                    if (lock) return;
                    if (card.classList.contains('matched') || card.classList.contains('flipped')) return;

                    card.classList.add('flipped');
                    card.textContent = sym;

                    if (firstIndex === null) {
                        firstIndex = idx;
                    } else {
                        lock = true;
                        attempts++;
                        const prevCard = grid.querySelector(`.memory-card[data-index="${firstIndex}"]`);
                        if (prevCard && prevCard.dataset.symbol === sym) {
                            // match
                            setTimeout(() => {
                                card.classList.remove('flipped');
                                prevCard.classList.remove('flipped');
                                card.classList.add('matched');
                                prevCard.classList.add('matched');
                                card.textContent = sym;
                                prevCard.textContent = sym;
                                matched++;
                                updateStats();
                                lock = false;
                                firstIndex = null;
                                if (matched === symbols.length / 2) {
                                    alert("Ø§ÙƒØªÙ…Ù„Øª ÙƒÙ„ Ø§Ù„Ø£Ø²ÙˆØ§Ø¬! Ø­Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø±Ø© Ø§Ù„ÙØ§Ø¦Ø²Ø© ÙˆØ£Ø¶Ù Ù„Ù‡Ø§ Ù†Ù‚Ø§Ø·Ù‹Ø§.");
                                }
                            }, 400);
                        } else {
                            // not match
                            setTimeout(() => {
                                card.classList.remove('flipped');
                                prevCard.classList.remove('flipped');
                                card.textContent = "";
                                prevCard.textContent = "";
                                updateStats();
                                lock = false;
                                firstIndex = null;
                            }, 600);
                        }
                    }
                });
                grid.appendChild(card);
            });

            function updateStats() {
                const stats = wrapper.querySelector('#memoryStats');
                stats.textContent = `Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª: ${attempts} | Ø§Ù„Ø£Ø²ÙˆØ§Ø¬ Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©: ${matched} / 4`;
            }

            container.appendChild(wrapper);
            container.appendChild(grid);
        }

        // ========== 2) Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±Ø¹Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ ==========
        function initReactionGame(container) {
            const box = document.createElement('div');
            box.className = "reaction-box";
            box.innerHTML = `
            <div>ÙŠØ´Ø§Ø±Ùƒ Ù…Ù…Ø«Ù„ Ù…Ù† ÙƒÙ„ Ø£Ø³Ø±Ø© Ø¨Ø§Ù„ØªÙ†Ø§ÙˆØ¨ Ø£Ùˆ ÙÙŠ ÙƒÙ„ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ØŒ ÙˆØ§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ Ø§Ù„Ø£Ø³Ø±Ø¹ ÙÙŠ Ø§Ù„Ø¶ØºØ· Ø¨Ø¹Ø¯ ØªØºÙŠÙ‘Ø± Ø§Ù„Ù„ÙˆÙ†.</div>
            <div style="margin-top:6px;">Ø§Ø¶ØºØ· "Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±"ØŒ Ø«Ù… Ø§Ù†ØªØ¸Ø± Ø­ØªÙ‰ ÙŠØªØºÙŠØ± Ø§Ù„Ù„ÙˆÙ†ØŒ Ø«Ù… Ø§Ø¶ØºØ· Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø¨Ø£Ø³Ø±Ø¹ Ù…Ø§ ÙŠÙ…ÙƒÙ†.</div>
            <button class="btn-main" id="reactionStartBtn">Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
            <div id="reactionStatus" style="margin-top:8px;">Ø§Ù„Ø­Ø§Ù„Ø©: ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
        `;
            const area = document.createElement('div');
            area.className = "reaction-area";
            area.textContent = "Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ø¹Ù†Ø¯Ù…Ø§ ÙŠØªØºÙŠØ± Ø§Ù„Ù„ÙˆÙ†";
            let waiting = false;
            let ready = false;
            let startTime = 0;
            let timeoutId = null;

            const statusEl = box.querySelector('#reactionStatus');
            const startBtn = box.querySelector('#reactionStartBtn');

            startBtn.addEventListener('click', () => {
                if (timeoutId) clearTimeout(timeoutId);
                waiting = true;
                ready = false;
                area.style.background = "var(--palette-sage, #6F8F72)";
                statusEl.textContent = "Ø§Ù„Ø­Ø§Ù„Ø©: Ø§Ù†ØªØ¸Ø± Ø§Ù„ØªØºÙŠÙ‘Ø±...";
                const delay = 1000 + Math.random() * 3000;
                timeoutId = setTimeout(() => {
                    waiting = false;
                    ready = true;
                    area.style.background = "#27ae60";
                    statusEl.textContent = "Ø§Ù„Ø­Ø§Ù„Ø©: Ø§Ø¶ØºØ· Ø§Ù„Ø¢Ù†!";
                    startTime = performance.now();
                }, delay);
            });

            area.addEventListener('click', () => {
                if (waiting) {
                    statusEl.textContent = "Ø¶ØºØ·Øª Ø¨Ø¯Ø±ÙŠ! Ø£Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©.";
                    if (timeoutId) clearTimeout(timeoutId);
                    waiting = false;
                    ready = false;
                    area.style.background = "#e74c3c";
                } else if (ready) {
                    const end = performance.now();
                    const diff = Math.round(end - startTime);
                    statusEl.textContent = `Ø²Ù…Ù† Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©: ${diff} Ù…Ù„Ù„ÙŠ Ø«Ø§Ù†ÙŠØ©.`;
                    ready = false;
                    area.style.background = "var(--palette-sage, #6F8F72)";
                    alert("Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø²Ù…Ù† Ù„Ù„Ø£Ø³Ø±Ø©ØŒ ÙˆÙ‚Ø§Ø±Ù† Ø¨ÙŠÙ†Ù‡Ø§ Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ø³Ø±Ø¹.");
                }
            });

            container.appendChild(box);
            container.appendChild(area);
        }

        // ========== 3) Ø§Ø¶Ø±Ø¨ Ø§Ù„Ø®Ù„Ø¯ ==========
        function initMoleGame(container) {
            const info = document.createElement('div');
            info.innerHTML = `
            <div>ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù„Ø¹Ø¨Ø©: ÙƒÙ„ Ù…Ø±Ø© ÙŠØ¸Ù‡Ø± ğŸ¹ ÙÙŠ Ù…Ø±Ø¨Ø¹ØŒ Ø§Ø¶ØºØ· Ø¹Ù„ÙŠÙ‡ Ø¨Ø³Ø±Ø¹Ø©. Ù„Ø¯ÙŠÙƒ 20 Ø«Ø§Ù†ÙŠØ©.</div>
            <div>Ø§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ Ù…Ù† ÙŠØ­ØµÙ„ Ø¹Ù„Ù‰ Ø£Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø¶Ø±Ø¨Ø§Øª ØµØ­ÙŠØ­Ø©.</div>
            <button class="btn-main" id="moleStartBtn">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <div id="moleStatus" style="margin-top:6px;">Ø§Ù„Ù†Ù‚Ø§Ø·: 0 | Ø§Ù„ÙˆÙ‚Øª: -</div>
        `;
            const grid = document.createElement('div');
            grid.className = "mole-grid";

            for (let i = 0; i < 9; i++) {
                const cell = document.createElement('div');
                cell.className = "mole-cell";
                cell.dataset.index = i;
                cell.textContent = "";
                grid.appendChild(cell);
            }

            let score = 0;
            let timeLeft = 0;
            let moleIndex = -1;
            let intervalId = null;
            let timerId = null;

            const statusEl = info.querySelector('#moleStatus');
            const startBtn = info.querySelector('#moleStartBtn');

            function setMole(newIndex) {
                const cells = grid.querySelectorAll('.mole-cell');
                cells.forEach(c => {
                    c.classList.remove('mole');
                    c.textContent = "";
                });
                if (newIndex >= 0) {
                    const target = grid.querySelector(`.mole-cell[data-index="${newIndex}"]`);
                    if (target) {
                        target.classList.add('mole');
                        target.textContent = "ğŸ¹";
                    }
                }
            }

            grid.addEventListener('click', (e) => {
                const cell = e.target.closest('.mole-cell');
                if (!cell) return;
                if (cell.classList.contains('mole')) {
                    score++;
                    setMole(-1);
                    statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                }
            });

            startBtn.addEventListener('click', () => {
                // Ø¥Ø¹Ø§Ø¯Ø©
                score = 0;
                timeLeft = 20;
                statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                setMole(-1);
                if (intervalId) clearInterval(intervalId);
                if (timerId) clearInterval(timerId);

                intervalId = setInterval(() => {
                    const idx = Math.floor(Math.random() * 9);
                    moleIndex = idx;
                    setMole(idx);
                }, 700);

                timerId = setInterval(() => {
                    timeLeft--;
                    statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                    if (timeLeft <= 0) {
                        clearInterval(intervalId);
                        clearInterval(timerId);
                        setMole(-1);
                        if (!isMiniGameOverlayOpen()) return;
                        alert(`Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}. Ø§Ø®ØªØ± Ø§Ù„Ø£Ø³Ø±Ø© Ø§Ù„ÙØ§Ø¦Ø²Ø© Ø­Ø³Ø¨ Ø£Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø©.`);
                    }
                }, 1000);
                registerMiniGameTimer(intervalId);
                registerMiniGameTimer(timerId);
            });

            container.appendChild(info);
            container.appendChild(grid);
        }

        // ========== 4) ØªØ®Ù…ÙŠÙ† Ø§Ù„Ø±Ù‚Ù… ==========
        function initGuessNumberGame(container) {
            const secret = Math.floor(Math.random() * 100) + 1;
            let attempts = 0;

            const box = document.createElement('div');
            box.innerHTML = `
            <div>Ø§Ù„Ø­Ø§Ø³ÙˆØ¨ Ø§Ø®ØªØ§Ø± Ø±Ù‚Ù… Ø¨ÙŠÙ† 1 Ùˆ 100. Ø§Ù„Ø£Ø³Ø± ØªØªÙ†Ø§ÙˆØ¨ Ø¹Ù„Ù‰ Ø§Ù„ØªØ®Ù…ÙŠÙ†.</div>
            <div>Ù…Ù† ÙŠØ¬Ø¯ Ø§Ù„Ø±Ù‚Ù… Ø¨Ø£Ù‚Ù„ Ø¹Ø¯Ø¯ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù‡Ùˆ Ø§Ù„ÙØ§Ø¦Ø².</div>
            <div style="margin-top:6px;">
                <input id="guessInput" type="number" placeholder="ØªØ®Ù…ÙŠÙ†Ùƒ Ù‡Ù†Ø§">
                <button class="btn-main" id="guessBtn">ØªØ­Ù‚Ù‚</button>
            </div>
            <div id="guessStatus" style="margin-top:6px;">Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©: Ù„Ù… ØªØ¨Ø¯Ø£ Ø¨Ø¹Ø¯.</div>
        `;
            const guessInput = box.querySelector('#guessInput');
            const guessBtn = box.querySelector('#guessBtn');
            const statusEl = box.querySelector('#guessStatus');

            guessBtn.addEventListener('click', () => {
                const val = Number(guessInput.value);
                if (!val || val < 1 || val > 100) {
                    alert("Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù…Ù‹Ø§ Ø¨ÙŠÙ† 1 Ùˆ 100");
                    return;
                }
                attempts++;
                if (val === secret) {
                    statusEl.textContent = `ØµØ­ÙŠØ­! Ø§Ù„Ø±Ù‚Ù… Ù‡Ùˆ ${secret}. Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª: ${attempts}.`;
                    alert("Ø­Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø±Ø© Ø§Ù„ÙØ§Ø¦Ø²Ø© Ø­Ø³Ø¨ Ù…Ù† Ø§ÙƒØªØ´Ù Ø§Ù„Ø±Ù‚Ù…ØŒ ÙˆØ£Ø¶Ù Ù„Ù‡Ø§ Ù†Ù‚Ø§Ø·Ù‹Ø§.");
                } else if (val < secret) {
                    statusEl.textContent = `Ø£Ø¹Ù„Ù‰ Ù…Ù† ${val} (Ù…Ø­Ø§ÙˆÙ„Ø§Øª: ${attempts}).`;
                } else {
                    statusEl.textContent = `Ø£Ù‚Ù„ Ù…Ù† ${val} (Ù…Ø­Ø§ÙˆÙ„Ø§Øª: ${attempts}).`;
                }
                guessInput.value = "";
            });

            container.appendChild(box);
        }

        // ========== 5) ØªØ­Ø¯ÙŠ Ø§Ù„Ù†Ù‚Ø± Ø§Ù„Ø³Ø±ÙŠØ¹ ==========
        function initClickerGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>Ø§Ø®ØªØ± Ù…Ù…Ø«Ù„Ù‹Ø§ Ù…Ù† ÙƒÙ„ Ø£Ø³Ø±Ø©. ÙƒÙ„ ÙˆØ§Ø­Ø¯ ÙŠØ­Ø§ÙˆÙ„ Ø§Ù„Ù†Ù‚Ø± Ø£ÙƒØ¨Ø± Ø¹Ø¯Ø¯ Ù…Ù…ÙƒÙ† ÙÙŠ 5 Ø«ÙˆØ§Ù†.</div>
            <div style="margin-top:6px;">Ø§Ø¶ØºØ· "Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©" Ø«Ù… Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ø¨Ø£Ù‚ØµÙ‰ Ø³Ø±Ø¹Ø©.</div>
            <button class="btn-main" id="clickerStart">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <div id="clickerInfo" style="margin-top:6px;">Ø§Ù„Ù†Ù‚Ø±Ø§Øª: 0 | Ø§Ù„ÙˆÙ‚Øª: -</div>
            <button class="btn-green" id="clickerBtn" style="margin-top:8px;">Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ø¨Ø³Ø±Ø¹Ø©!</button>
        `;
            const startBtn = box.querySelector('#clickerStart');
            const infoEl = box.querySelector('#clickerInfo');
            const clickBtn = box.querySelector('#clickerBtn');

            let clicks = 0;
            let timeLeft = 0;
            let active = false;
            let timerId = null;

            startBtn.addEventListener('click', () => {
                clicks = 0;
                timeLeft = 5;
                active = true;
                infoEl.textContent = `Ø§Ù„Ù†Ù‚Ø±Ø§Øª: ${clicks} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                if (timerId) clearInterval(timerId);
                timerId = setInterval(() => {
                    timeLeft--;
                    infoEl.textContent = `Ø§Ù„Ù†Ù‚Ø±Ø§Øª: ${clicks} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                    if (timeLeft <= 0) {
                        active = false;
                        clearInterval(timerId);
                        if (!isMiniGameOverlayOpen()) return;
                        alert(`Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ù‚Ø±Ø§Øª: ${clicks}. Ø³Ø¬Ù‘Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø£Ø³Ø±Ø©.`);
                    }
                }, 1000);
                registerMiniGameTimer(timerId);
            });

            clickBtn.addEventListener('click', () => {
                if (!active) return;
                clicks++;
                infoEl.textContent = `Ø§Ù„Ù†Ù‚Ø±Ø§Øª: ${clicks} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
            });

            container.appendChild(box);
        }

        // ========== 6) Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ù…Ø®ØªÙ„Ù ==========
        function initOddColorGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>ØªØ¸Ù‡Ø± Ø´Ø¨ÙƒØ© Ù…Ù† Ø§Ù„Ø£Ù„ÙˆØ§Ù†ØŒ ÙˆØ§Ø­Ø¯ Ù…Ù†Ù‡Ø§ Ù…Ø®ØªÙ„Ù Ù‚Ù„ÙŠÙ„Ø§Ù‹. Ù…Ù† Ø£Ø³Ø±Ø¹ Ø£Ø³Ø±Ø© ØªØ¬Ø¯ Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ù…Ø®ØªÙ„Ù ØªÙÙˆØ².</div>
            <div style="margin-top:6px;">Ù„Ø¯ÙŠÙƒ 20 Ø«Ø§Ù†ÙŠØ© Ù„Ø¥ÙŠØ¬Ø§Ø¯ Ø£ÙƒØ¨Ø± Ø¹Ø¯Ø¯ Ù…Ù† Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…Ø®ØªÙ„ÙØ©.</div>
            <button class="btn-main" id="oddStart">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <div id="oddStatus" style="margin-top:6px;">Ø§Ù„Ù†Ù‚Ø§Ø·: 0 | Ø§Ù„ÙˆÙ‚Øª: -</div>
        `;
            const grid = document.createElement('div');
            grid.className = "color-grid";

            const startBtn = box.querySelector('#oddStart');
            const statusEl = box.querySelector('#oddStatus');

            let oddIndex = -1;
            let clickable = false;
            let score = 0;
            let timeLeft = 20;
            let timerId = null;
            let running = false;

            function newRound() {
                grid.innerHTML = "";
                clickable = true;
                const size = 16;
                const baseHue = Math.floor(Math.random() * 360);
                const baseColor = `hsl(${baseHue}, 60%, 50%)`;
                const oddColor = `hsl(${baseHue}, 60%, 60%)`;
                oddIndex = Math.floor(Math.random() * size);

                for (let i = 0; i < size; i++) {
                    const cell = document.createElement('div');
                    cell.className = "color-cell";
                    cell.style.background = (i === oddIndex) ? oddColor : baseColor;
                    cell.dataset.index = i;
                    grid.appendChild(cell);
                }
                statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
            }

            grid.addEventListener('click', (e) => {
                const cell = e.target.closest('.color-cell');
                if (!cell || !clickable || !running) return;
                const idx = Number(cell.dataset.index);
                if (idx === oddIndex) {
                    score++;
                    statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                    newRound();
                } else {
                    statusEl.textContent = `Ø®Ø·Ø£! Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                }
            });

            startBtn.addEventListener('click', () => {
                if (timerId) clearInterval(timerId);
                score = 0;
                timeLeft = 20;
                running = true;
                newRound();
                timerId = setInterval(() => {
                    timeLeft--;
                    statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                    if (timeLeft <= 0) {
                        running = false;
                        clickable = false;
                        clearInterval(timerId);
                        if (!isMiniGameOverlayOpen()) return;
                        alert(`Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}. Ø³Ø¬Ù‘Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø£Ø³Ø±Ø©.`);
                    }
                }, 1000);
                registerMiniGameTimer(timerId);
            });

            container.appendChild(box);
            container.appendChild(grid);
        }

        // ========== 7) Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±Ø¹Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø© ==========
        function initTypingGame(container) {
            const texts = [
                "Ø§Ù„ØªØ¹Ø§ÙˆÙ† Ø³Ø± Ø§Ù„Ù†Ø¬Ø§Ø­ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø³Ø±.",
                "Ø§Ù„ØªØ±ÙƒÙŠØ² ÙˆØ§Ù„Ø³Ø±Ø¹Ø© ÙŠÙ„Ø¹Ø¨Ø§Ù† Ø¯ÙˆØ±Ù‹Ø§ Ù…Ù‡Ù…Ù‹Ø§ ÙÙŠ Ø§Ù„ÙÙˆØ².",
                "Ù…Ù† Ø³ÙŠØ±Ø¨Ø­ Ø§Ù„Ù…Ù„ÙŠÙˆÙ† ÙŠØ¨Ø¯Ø£ Ù…Ù† Ù†Ù‚Ø·Ø© ÙˆØ§Ø­Ø¯Ø©.",
                "Ø§Ù„Ø¨Ø·ÙˆÙ„Ø© ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø­Ù…Ø§Ø³ ÙˆØ¹Ø¯Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø¬Ù…ÙŠØ¹."
            ];
            const targetText = texts[Math.floor(Math.random() * texts.length)];

            const box = document.createElement('div');
            box.className = "typing-box";
            box.innerHTML = `
            <div>Ø§Ø®ØªØ± Ù…Ù…Ø«Ù„Ù‹Ø§ Ù…Ù† ÙƒÙ„ Ø£Ø³Ø±Ø©. Ù…Ù† ÙŠÙƒØªØ¨ Ø§Ù„Ø¬Ù…Ù„Ø© Ø¨Ø£Ø³Ø±Ø¹ ÙˆÙ‚Øª ÙˆØ¨Ø£Ù‚Ù„ Ø£Ø®Ø·Ø§Ø¡ ÙŠÙÙˆØ².</div>
            <div style="margin-top:6px;">Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ÙƒØªØ§Ø¨ØªÙ‡:</div>
            <div style="margin-top:4px;padding:8px;border-radius:8px;background:#E8E2D8;border:1px solid #BFC6C4;">
                ${targetText}
            </div>
            <button class="btn-main" id="typingStart">Ø¨Ø¯Ø¡ Ø§Ù„Ù‚ÙŠØ§Ø³</button>
            <div style="margin-top:6px;">Ø§ÙƒØªØ¨ Ù‡Ù†Ø§:</div>
            <textarea id="typingArea" disabled></textarea>
            <div id="typingStatus" style="margin-top:6px;">Ø§Ù„ÙˆÙ‚Øª: - | Ø§Ù„Ø¯Ù‚Ø©: -</div>
        `;
            const startBtn = box.querySelector('#typingStart');
            const textArea = box.querySelector('#typingArea');
            const statusEl = box.querySelector('#typingStatus');

            let startTime = null;
            let finished = false;

            startBtn.addEventListener('click', () => {
                textArea.value = "";
                textArea.disabled = false;
                textArea.focus();
                finished = false;
                startTime = performance.now();
                statusEl.textContent = "Ø§Ù„ÙˆÙ‚Øª: Ø¬Ø§Ø±ÙŠ... | Ø§Ù„Ø¯Ù‚Ø©: -";
            });

            textArea.addEventListener('input', () => {
                if (!startTime || finished) return;
                const current = textArea.value;
                if (current === targetText) {
                    const end = performance.now();
                    finished = true;
                    const timeSec = ((end - startTime) / 1000).toFixed(2);
                    statusEl.textContent = `Ø§Ù„ÙˆÙ‚Øª: ${timeSec} Ø«Ø§Ù†ÙŠØ© | Ø§Ù„Ø¯Ù‚Ø©: 100%`;
                    textArea.disabled = true;
                    alert("Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø²Ù…Ù† Ù„Ù„Ø£Ø³Ø±Ø©ØŒ ÙˆÙ‚Ø§Ø±Ù† Ø¨ÙŠÙ† Ø§Ù„Ø¬Ù…ÙŠØ¹ Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙØ§Ø¦Ø².");
                } else {
                    // ØªÙ‚Ø¯ÙŠØ± Ø§Ù„Ø¯Ù‚Ø© Ù…Ø¨Ø¯Ø¦ÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„ØµØ­ÙŠØ­Ø©
                    let correct = 0;
                    for (let i = 0; i < Math.min(current.length, targetText.length); i++) {
                        if (current[i] === targetText[i]) correct++;
                    }
                    const accuracy = ((correct / targetText.length) * 100).toFixed(0);
                    statusEl.textContent = `Ø§Ù„ÙˆÙ‚Øª: Ø¬Ø§Ø±ÙŠ... | Ø§Ù„Ø¯Ù‚Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠØ©: ${accuracy}%`;
                }
            });

            container.appendChild(box);
        }

        // ========== 8) Ø³Ù„Ù… Ø§Ù„Ø£Ø±Ù‚Ø§Ù… (Ø¬Ù…Ø¹/Ø·Ø±Ø­ Ø°Ù‡Ù†ÙŠ) ==========
        function initMentalStepsGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>ØªÙØ¹Ø±Ø¶ Ø³Ù„Ø³Ù„Ø© Ø¹Ù…Ù„ÙŠØ§Øª Ø¬Ù…Ø¹ ÙˆØ·Ø±Ø­. Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø± Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù†Ø§ØªØ¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø°Ù‡Ù†ÙŠÙ‹Ø§.</div>
            <div>Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø³Ù„Ø³Ù„Ø©ØŒ Ø§Ø³Ø£Ù„: "Ù…Ø§ Ø§Ù„Ù†Ø§ØªØ¬ØŸ" ÙˆØ§Ù„ÙØ§Ø¦Ø² Ù…Ù† ÙŠØ¹Ø·ÙŠ Ø§Ù„Ù†Ø§ØªØ¬ Ø§Ù„ØµØ­ÙŠØ­.</div>
            <button class="btn-main" id="msStart">Ø¨Ø¯Ø¡ Ø§Ù„Ø³Ù„Ø³Ù„Ø©</button>
            <div id="msSequence" style="margin-top:8px;"></div>
        `;
            const startBtn = box.querySelector('#msStart');
            const seqEl = box.querySelector('#msSequence');
            let answerTimer = null;
            let startTime = null;

            startBtn.addEventListener('click', () => {
                seqEl.innerHTML = "";
                let current = Math.floor(Math.random() * 20);
                const steps = [];
                for (let i = 0; i < 6; i++) {
                    const delta = Math.floor(Math.random() * 9) + 1;
                    const op = Math.random() < 0.5 ? "+" : "-";
                    steps.push({ op, delta });
                }

                let idx = 0;
                const baseDiv = document.createElement('div');
                baseDiv.textContent = `Ø§Ø¨Ø¯Ø£ Ù…Ù†: ${current}`;
                seqEl.appendChild(baseDiv);

                const stepDiv = document.createElement('div');
                stepDiv.style.marginTop = "6px";
                seqEl.appendChild(stepDiv);

                const timer = setInterval(() => {
                    if (idx >= steps.length) {
                        clearInterval(timer);
                        const final = steps.reduce((acc, s) => s.op === "+" ? acc + s.delta : acc - s.delta, current);
                        const msg = document.createElement('div');
                        msg.style.marginTop = "8px";
                        msg.textContent = "Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø³Ù„Ø³Ù„Ø©! Ø§Ø³Ø£Ù„ Ø§Ù„Ø£Ø³Ø± Ø¹Ù† Ø§Ù„Ù†Ø§ØªØ¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØŒ Ø«Ù… Ø§Ø¶ØºØ· Ù„Ø¹Ø±Ø¶Ù‡:";
                        const btnShow = document.createElement('button');
                        btnShow.className = "btn-blue";
                        btnShow.textContent = "Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø§ØªØ¬";
                        const timeDisplay = document.createElement('div');
                        timeDisplay.id = "msTimer";
                        timeDisplay.style.marginTop = "6px";
                        timeDisplay.textContent = "Ø§Ù„ÙˆÙ‚Øª: 0.0 Ø«Ø§Ù†ÙŠØ©";
                        startTime = performance.now();
                        btnShow.addEventListener('click', () => {
                            if (answerTimer) clearInterval(answerTimer);
                            const elapsed = ((performance.now() - startTime) / 1000).toFixed(1);
                            alert(`Ø§Ù„Ù†Ø§ØªØ¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù‡Ùˆ: ${final}\nØ§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø³ØªØºØ±Ù‚: ${elapsed} Ø«Ø§Ù†ÙŠØ©`);
                        });
                        msg.appendChild(document.createElement('br'));
                        msg.appendChild(btnShow);
                        msg.appendChild(timeDisplay);
                        seqEl.appendChild(msg);
                        answerTimer = setInterval(() => {
                            if (startTime) {
                                const elapsed = ((performance.now() - startTime) / 1000).toFixed(1);
                                timeDisplay.textContent = `Ø§Ù„ÙˆÙ‚Øª: ${elapsed} Ø«Ø§Ù†ÙŠØ©`;
                            }
                        }, 100);
                        return;
                    }
                    const s = steps[idx];
                    stepDiv.textContent += ` ${s.op} ${s.delta}`;
                    idx++;
                }, 1200);
            });

            container.appendChild(box);
        }

        // ========== 9) Ù„Ø¹Ø¨Ø© Ø§Ù„Ø«Ø¹Ø¨Ø§Ù† ==========
        function initSnakeGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø«Ø¹Ø¨Ø§Ù† Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ø³Ù‡Ù…. ÙƒÙ„Ù…Ø§ Ø£ÙƒÙ„Øª Ø§Ù„Ø·Ø¹Ø§Ù…ØŒ ÙŠÙƒØ¨Ø± Ø§Ù„Ø«Ø¹Ø¨Ø§Ù†.</div>
            <div style="margin-top:6px;">Ø§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ Ù…Ù† ÙŠØ­ØµÙ„ Ø¹Ù„Ù‰ Ø£Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø· Ù‚Ø¨Ù„ Ø§Ù„Ø§ØµØ·Ø¯Ø§Ù… Ø£Ùˆ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙˆÙ‚Øª.</div>
            <button class="btn-main" id="snakeStart">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <div id="snakeStatus" style="margin-top:6px;">Ø§Ù„Ù†Ù‚Ø§Ø·: 0 | Ø§Ù„ÙˆÙ‚Øª: -</div>
        `;
            const canvas = document.createElement('canvas');
            canvas.width = 240;
            canvas.height = 240;
            canvas.style.border = "2px solid #f1c40f";
            canvas.style.display = "block";
            canvas.style.margin = "10px auto";
            canvas.style.background = "#050815";

            const ctx = canvas.getContext('2d');
            const gridSize = 12;
            let snake = [{x: 10, y: 10}];
            let direction = {x: 1, y: 0};
            let food = {x: 15, y: 15};
            let score = 0;
            let timeLeft = 60;
            let gameLoop = null;
            let timerId = null;
            let running = false;

            const statusEl = box.querySelector('#snakeStatus');
            const startBtn = box.querySelector('#snakeStart');

            function draw() {
                ctx.fillStyle = "#050815";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = "#2ecc71";
                snake.forEach(seg => {
                    ctx.fillRect(seg.x * gridSize, seg.y * gridSize, gridSize - 2, gridSize - 2);
                });
                ctx.fillStyle = "#e74c3c";
                ctx.fillRect(food.x * gridSize, food.y * gridSize, gridSize - 2, gridSize - 2);
            }

            function generateFood() {
                let newFood;
                do {
                    newFood = {
                        x: Math.floor(Math.random() * (canvas.width / gridSize)),
                        y: Math.floor(Math.random() * (canvas.height / gridSize))
                    };
                } while (snake.some(seg => seg.x === newFood.x && seg.y === newFood.y));
                return newFood;
            }

            function move() {
                if (!running) return;
                const head = {x: snake[0].x + direction.x, y: snake[0].y + direction.y};
                if (head.x < 0 || head.x >= canvas.width / gridSize || head.y < 0 || head.y >= canvas.height / gridSize) {
                    endGame();
                    return;
                }
                if (snake.some(seg => seg.x === head.x && seg.y === head.y)) {
                    endGame();
                    return;
                }
                snake.unshift(head);
                if (head.x === food.x && head.y === food.y) {
                    score++;
                    statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                    food = generateFood();
                } else {
                    snake.pop();
                }
                draw();
            }

            function endGame() {
                running = false;
                if (gameLoop) clearInterval(gameLoop);
                if (timerId) clearInterval(timerId);
                alert(`Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¬ÙˆÙ„Ø©! Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}. Ø³Ø¬Ù‘Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø£Ø³Ø±Ø©.`);
            }

            startBtn.addEventListener('click', () => {
                if (gameLoop) clearInterval(gameLoop);
                if (timerId) clearInterval(timerId);
                snake = [{x: 10, y: 10}];
                direction = {x: 1, y: 0};
                score = 0;
                timeLeft = 60;
                running = true;
                food = generateFood();
                statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                draw();
                gameLoop = setInterval(move, 150);
                timerId = setInterval(() => {
                    if (!running) {
                        clearInterval(timerId);
                        return;
                    }
                    timeLeft--;
                    statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                    if (timeLeft <= 0) {
                        endGame();
                    }
                }, 1000);
            });

            document.addEventListener('keydown', (e) => {
                if (!running) return;
                if (e.key === 'ArrowUp' && direction.y === 0) direction = {x: 0, y: -1};
                if (e.key === 'ArrowDown' && direction.y === 0) direction = {x: 0, y: 1};
                if (e.key === 'ArrowLeft' && direction.x === 0) direction = {x: -1, y: 0};
                if (e.key === 'ArrowRight' && direction.x === 0) direction = {x: 1, y: 0};
            });

            container.appendChild(box);
            container.appendChild(canvas);
        }

        // ========== 10) Ù„Ø¹Ø¨Ø© Ø§Ù„Ø·Ø§Ø¦Ø± Ø§Ù„Ø·Ø§Ø¦Ø± ==========
        function initFlappyGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>Ø§Ø¶ØºØ· Ø§Ù„Ù…Ø³Ø§ÙØ© Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø·Ø§Ø¦Ø± Ù„Ù„Ø£Ø¹Ù„Ù‰. ØªØ¬Ù†Ø¨ Ø§Ù„Ø£Ù†Ø§Ø¨ÙŠØ¨.</div>
            <div style="margin-top:6px;">Ø§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ Ù…Ù† ÙŠÙ…Ø± Ø¨Ø£ÙƒØ¨Ø± Ø¹Ø¯Ø¯ Ù…Ù† Ø§Ù„Ø£Ù†Ø§Ø¨ÙŠØ¨. Ø§Ù„Ø³Ø±Ø¹Ø© ØªØ²ÙŠØ¯ Ù…Ø¹ Ø§Ù„ÙˆÙ‚Øª.</div>
            <button class="btn-main" id="flappyStart">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <div id="flappyStatus" style="margin-top:6px;">Ø§Ù„Ù†Ù‚Ø§Ø·: 0</div>
        `;
            const canvas = document.createElement('canvas');
            canvas.width = 300;
            canvas.height = 400;
            canvas.style.border = "2px solid #f1c40f";
            canvas.style.display = "block";
            canvas.style.margin = "10px auto";
            canvas.style.background = "#87CEEB";
            canvas.style.cursor = "pointer";

            const ctx = canvas.getContext('2d');
            let birdY = 200;
            let birdVel = 0;
            let pipes = [];
            let score = 0;
            let gameLoop = null;
            let running = false;
            let pipeSpeed = 2;
            let gameTime = 0;

            const statusEl = box.querySelector('#flappyStatus');
            const startBtn = box.querySelector('#flappyStart');

            function draw() {
                ctx.fillStyle = "#87CEEB";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = "#f1c40f";
                ctx.fillRect(50, birdY, 30, 20);
                ctx.fillStyle = "#2ecc71";
                pipes.forEach(pipe => {
                    ctx.fillRect(pipe.x, 0, 40, pipe.top);
                    ctx.fillRect(pipe.x, pipe.top + pipe.gap, 40, canvas.height);
                });
            }

            function update() {
                if (!running) return;
                gameTime++;
                pipeSpeed = 2 + Math.floor(gameTime / 300);
                birdVel += 0.5;
                birdY += birdVel;
                if (birdY >= canvas.height - 20 || birdY <= 0) {
                    endGame();
                    return;
                }
                if (pipes.length === 0 || pipes[pipes.length - 1].x < canvas.width - 150) {
                    const gap = 120;
                    const top = Math.random() * (canvas.height - gap - 100) + 50;
                    pipes.push({x: canvas.width, top, gap});
                }
                pipes.forEach((pipe, idx) => {
                    pipe.x -= pipeSpeed;
                    if (pipe.x + 40 < 50 && pipe.x + 40 > 20) {
                        if (birdY < pipe.top || birdY + 20 > pipe.top + pipe.gap) {
                            endGame();
                            return;
                        }
                    }
                    if (pipe.x + 40 < 50 && pipe.x > 0) {
                        score++;
                        statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}`;
                        pipes.splice(idx, 1);
                    }
                });
                pipes = pipes.filter(p => p.x > -40);
                draw();
            }

            function endGame() {
                running = false;
                if (gameLoop) clearInterval(gameLoop);
                alert(`Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¬ÙˆÙ„Ø©! Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}. Ø³Ø¬Ù‘Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø£Ø³Ø±Ø©.`);
            }

            let gameStarted = false;

            function jump(e) {
                if (!gameStarted) {
                    if (running) {
                        gameStarted = true;
                        gameLoop = setInterval(update, 16);
                    }
                    e.preventDefault();
                    return;
                }
                if (!running) {
                    e.preventDefault();
                    return;
                }
                birdVel = -5;
            }

            startBtn.addEventListener('click', () => {
                if (gameLoop) clearInterval(gameLoop);
                birdY = 200;
                birdVel = 0;
                pipes = [];
                score = 0;
                gameTime = 0;
                pipeSpeed = 2;
                running = true;
                gameStarted = false;
                statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ø¶ØºØ· Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø·ÙŠØ±Ø§Ù†`;
                draw();
            });

            canvas.addEventListener('click', (e) => {
                jump(e);
            });
            document.addEventListener('keydown', (e) => {
                if (e.key === ' ') {
                    e.preventDefault();
                    jump(e);
                }
            });

            container.appendChild(box);
            container.appendChild(canvas);
        }

        // ========== 11) Ø§Ù„Ù…ØªØ§Ù‡Ø© ==========
        function initMazeGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø³Ù‡Ù… Ù„Ù„ÙˆØµÙˆÙ„ Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© (Ø£Ø®Ø¶Ø±) Ø¥Ù„Ù‰ Ø§Ù„Ù†Ù‡Ø§ÙŠØ© (Ø£Ø­Ù…Ø±).</div>
            <div style="margin-top:6px;">Ø§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ Ù…Ù† ÙŠØµÙ„ Ø¨Ø£Ø³Ø±Ø¹ ÙˆÙ‚Øª.</div>
            <button class="btn-main" id="mazeStart">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <div id="mazeStatus" style="margin-top:6px;">Ø§Ù„ÙˆÙ‚Øª: -</div>
        `;
            const canvas = document.createElement('canvas');
            canvas.width = 300;
            canvas.height = 300;
            canvas.style.border = "2px solid #f1c40f";
            canvas.style.display = "block";
            canvas.style.margin = "10px auto";
            canvas.style.background = "#050815";

            const ctx = canvas.getContext('2d');
            const cellSize = 20;
            let playerX = 1;
            let playerY = 1;
            let startTime = null;
            let running = false;

            const mazes = [
                [
                    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
                    [1,0,0,0,1,0,0,0,0,0,0,0,0,0,1],
                    [1,1,1,0,1,0,1,1,1,1,1,0,1,0,1],
                    [1,0,0,0,0,0,0,0,0,0,1,0,1,0,1],
                    [1,0,1,1,1,1,1,1,1,0,1,0,1,0,1],
                    [1,0,0,0,0,0,0,0,1,0,0,0,1,0,1],
                    [1,1,1,1,1,0,1,0,1,1,1,1,1,0,1],
                    [1,0,0,0,0,0,1,0,0,0,0,0,0,0,1],
                    [1,0,1,1,1,1,1,1,1,1,1,0,1,1,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                    [1,1,1,1,1,1,1,1,1,1,1,1,1,0,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                    [1,0,1,1,1,1,1,1,1,1,1,1,1,1,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
                    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
                ],
                [
                    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
                    [1,0,1,0,0,0,0,0,1,0,0,0,0,0,1],
                    [1,0,1,0,1,1,1,0,1,0,1,1,1,0,1],
                    [1,0,0,0,1,0,0,0,0,0,1,0,0,0,1],
                    [1,1,1,1,1,0,1,1,1,1,1,0,1,1,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                    [1,0,1,1,1,1,1,0,1,1,1,1,1,0,1],
                    [1,0,0,0,0,0,1,0,1,0,0,0,0,0,1],
                    [1,1,1,1,1,0,1,0,1,0,1,1,1,1,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                    [1,0,1,1,1,1,1,1,1,1,1,1,1,0,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                    [1,1,1,1,1,1,1,0,1,1,1,1,1,1,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
                    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
                ],
                [
                    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
                    [1,0,0,0,0,0,1,0,1,0,0,0,0,0,1],
                    [1,0,1,1,1,0,1,0,1,0,1,1,1,0,1],
                    [1,0,1,0,0,0,0,0,0,0,0,0,1,0,1],
                    [1,0,1,0,1,1,1,1,1,1,1,0,1,0,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                    [1,1,1,1,1,0,1,1,1,0,1,1,1,1,1],
                    [1,0,0,0,0,0,1,0,1,0,0,0,0,0,1],
                    [1,0,1,1,1,0,1,0,1,0,1,1,1,0,1],
                    [1,0,0,0,1,0,0,0,0,0,1,0,0,0,1],
                    [1,1,1,0,1,1,1,1,1,1,1,0,1,1,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                    [1,0,1,1,1,1,1,1,1,1,1,1,1,0,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
                    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
                ],
                [
                    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
                    [1,0,0,0,1,0,0,0,0,0,1,0,0,0,1],
                    [1,0,1,0,1,0,1,1,1,0,1,0,1,0,1],
                    [1,0,1,0,0,0,1,0,1,0,0,0,1,0,1],
                    [1,0,1,1,1,1,1,0,1,1,1,1,1,0,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                    [1,1,1,0,1,1,1,1,1,1,1,0,1,1,1],
                    [1,0,0,0,1,0,0,0,0,0,1,0,0,0,1],
                    [1,0,1,1,1,0,1,1,1,0,1,1,1,0,1],
                    [1,0,0,0,0,0,1,0,1,0,0,0,0,0,1],
                    [1,1,1,1,1,0,1,0,1,0,1,1,1,1,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                    [1,0,1,1,1,1,1,1,1,1,1,1,1,0,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
                    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
                ],
                [
                    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
                    [1,0,1,0,0,0,0,0,0,0,0,0,1,0,1],
                    [1,0,1,0,1,1,1,1,1,1,1,0,1,0,1],
                    [1,0,0,0,1,0,0,0,0,0,1,0,0,0,1],
                    [1,1,1,1,1,0,1,1,1,0,1,1,1,1,1],
                    [1,0,0,0,0,0,1,0,1,0,0,0,0,0,1],
                    [1,0,1,1,1,0,1,0,1,0,1,1,1,0,1],
                    [1,0,0,0,1,0,0,0,0,0,1,0,0,0,1],
                    [1,1,1,0,1,1,1,0,1,1,1,0,1,1,1],
                    [1,0,0,0,0,0,1,0,1,0,0,0,0,0,1],
                    [1,0,1,1,1,0,1,0,1,0,1,1,1,0,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                    [1,1,1,1,1,1,1,0,1,1,1,1,1,1,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
                    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
                ],
                [
                    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                    [1,0,1,1,1,1,1,0,1,1,1,1,1,0,1],
                    [1,0,1,0,0,0,1,0,1,0,0,0,1,0,1],
                    [1,0,1,0,1,0,1,0,1,0,1,0,1,0,1],
                    [1,0,0,0,1,0,0,0,0,0,1,0,0,0,1],
                    [1,1,1,1,1,0,1,1,1,0,1,1,1,1,1],
                    [1,0,0,0,0,0,1,0,1,0,0,0,0,0,1],
                    [1,0,1,1,1,1,1,0,1,1,1,1,1,0,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                    [1,1,1,0,1,1,1,1,1,1,1,0,1,1,1],
                    [1,0,0,0,1,0,0,0,0,0,1,0,0,0,1],
                    [1,0,1,1,1,0,1,1,1,0,1,1,1,0,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
                    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
                ],
                [
                    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
                    [1,0,0,0,1,0,0,0,0,0,1,0,0,0,1],
                    [1,0,1,0,1,0,1,1,1,0,1,0,1,0,1],
                    [1,0,1,0,0,0,0,0,0,0,0,0,1,0,1],
                    [1,0,1,1,1,1,1,1,1,1,1,1,1,0,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                    [1,0,1,1,1,0,1,1,1,0,1,1,1,0,1],
                    [1,0,0,0,1,0,1,0,1,0,1,0,0,0,1],
                    [1,1,1,0,1,0,1,0,1,0,1,0,1,1,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                    [1,0,1,1,1,1,1,0,1,1,1,1,1,0,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                    [1,1,1,1,1,0,1,1,1,0,1,1,1,1,1],
                    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
                    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
                ]
            ];

            const statusEl = box.querySelector('#mazeStatus');
            const startBtn = box.querySelector('#mazeStart');
            
            function getMaze() {
                if (mazeCurrentIndex === -1) {
                    mazeCurrentIndex = Math.floor(Math.random() * mazes.length);
                }
                return mazes[mazeCurrentIndex];
            }

            function draw() {
                const maze = getMaze();
                ctx.fillStyle = "#050815";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                for (let r = 0; r < maze.length; r++) {
                    for (let c = 0; c < maze[r].length; c++) {
                        if (maze[r][c] === 1) {
                            ctx.fillStyle = "#34495e";
                            ctx.fillRect(c * cellSize, r * cellSize, cellSize, cellSize);
                        } else if (maze[r][c] === 2) {
                            ctx.fillStyle = "#e74c3c";
                            ctx.fillRect(c * cellSize, r * cellSize, cellSize, cellSize);
                        }
                    }
                }
                ctx.fillStyle = "#2ecc71";
                ctx.fillRect(playerX * cellSize, playerY * cellSize, cellSize, cellSize);
            }

            startBtn.addEventListener('click', () => {
                playerX = 1;
                playerY = 1;
                running = true;
                startTime = performance.now();
                draw();
                const timer = setInterval(() => {
                    if (!running) {
                        clearInterval(timer);
                        return;
                    }
                    const elapsed = ((performance.now() - startTime) / 1000).toFixed(1);
                    statusEl.textContent = `Ø§Ù„ÙˆÙ‚Øª: ${elapsed} Ø«Ø§Ù†ÙŠØ©`;
                }, 100);
            });

            document.addEventListener('keydown', (e) => {
                if (!running) return;
                const maze = getMaze();
                let newX = playerX;
                let newY = playerY;
                if (e.key === 'ArrowUp') newY--;
                if (e.key === 'ArrowDown') newY++;
                if (e.key === 'ArrowLeft') newX--;
                if (e.key === 'ArrowRight') newX++;
                if (newY >= 0 && newY < maze.length && newX >= 0 && newX < maze[0].length) {
                    if (maze[newY][newX] !== 1) {
                        playerX = newX;
                        playerY = newY;
                        if (maze[newY][newX] === 2) {
                            running = false;
                            const time = ((performance.now() - startTime) / 1000).toFixed(2);
                            alert(`ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! ÙˆØµÙ„Øª ÙÙŠ ${time} Ø«Ø§Ù†ÙŠØ©. Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø²Ù…Ù† Ù„Ù„Ø£Ø³Ø±Ø©.`);
                        }
                        draw();
                    }
                }
            });

            container.appendChild(box);
            container.appendChild(canvas);
        }

        // ========== 12) ÙƒØ§Ø³Ø­ Ø§Ù„Ø£Ù„ØºØ§Ù… ==========
        function initMinesweeperGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø±Ø¨Ø¹Ø§Øª Ù„Ù„ÙƒØ´Ù. ØªØ¬Ù†Ø¨ Ø§Ù„Ø£Ù„ØºØ§Ù…! Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ØªØ´ÙŠØ± Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù„ØºØ§Ù… Ø§Ù„Ù…Ø¬Ø§ÙˆØ±Ø©.</div>
            <div style="margin-top:6px;">Ø§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ Ù…Ù† ÙŠÙƒØ´Ù ÙƒÙ„ Ø§Ù„Ù…Ø±Ø¨Ø¹Ø§Øª Ø§Ù„Ø¢Ù…Ù†Ø©.</div>
            <button class="btn-main" id="minesweeperStart">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <div id="minesweeperStatus" style="margin-top:6px;">Ø§Ù„Ø£Ù„ØºØ§Ù…: 10</div>
        `;
            const grid = document.createElement('div');
            grid.style.display = "grid";
            grid.style.gridTemplateColumns = "repeat(10, 25px)";
            grid.style.gap = "2px";
            grid.style.justifyContent = "center";
            grid.style.marginTop = "10px";

            const rows = 10;
            const cols = 10;
            const mines = 10;
            let board = [];
            let revealed = [];
            let running = false;

            const statusEl = box.querySelector('#minesweeperStatus');
            const startBtn = box.querySelector('#minesweeperStart');

            function initBoard() {
                board = Array(rows).fill().map(() => Array(cols).fill(0));
                revealed = Array(rows).fill().map(() => Array(cols).fill(false));
                let placed = 0;
                while (placed < mines) {
                    const r = Math.floor(Math.random() * rows);
                    const c = Math.floor(Math.random() * cols);
                    if (board[r][c] !== -1) {
                        board[r][c] = -1;
                        placed++;
                    }
                }
                for (let r = 0; r < rows; r++) {
                    for (let c = 0; c < cols; c++) {
                        if (board[r][c] !== -1) {
                            let count = 0;
                            for (let dr = -1; dr <= 1; dr++) {
                                for (let dc = -1; dc <= 1; dc++) {
                                    if (r + dr >= 0 && r + dr < rows && c + dc >= 0 && c + dc < cols) {
                                        if (board[r + dr][c + dc] === -1) count++;
                                    }
                                }
                            }
                            board[r][c] = count;
                        }
                    }
                }
            }

            function reveal(r, c) {
                if (r < 0 || r >= rows || c < 0 || c >= cols || revealed[r][c]) return;
                revealed[r][c] = true;
                if (board[r][c] === -1) {
                    endGame(false);
                    return;
                }
                if (board[r][c] === 0) {
                    for (let dr = -1; dr <= 1; dr++) {
                        for (let dc = -1; dc <= 1; dc++) {
                            reveal(r + dr, c + dc);
                        }
                    }
                }
                checkWin();
                render();
            }

            function checkWin() {
                let safeRevealed = 0;
                for (let r = 0; r < rows; r++) {
                    for (let c = 0; c < cols; c++) {
                        if (revealed[r][c] && board[r][c] !== -1) safeRevealed++;
                    }
                }
                if (safeRevealed === rows * cols - mines) {
                    endGame(true);
                }
            }

            function endGame(won) {
                running = false;
                let safeRevealed = 0;
                let safeRemaining = 0;
                for (let r = 0; r < rows; r++) {
                    for (let c = 0; c < cols; c++) {
                        if (board[r][c] !== -1) {
                            if (revealed[r][c]) {
                                safeRevealed++;
                            } else {
                                safeRemaining++;
                            }
                        }
                        revealed[r][c] = true;
                    }
                }
                render();
                if (won) {
                    alert("ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! ÙØ²Øª! Ø³Ø¬Ù‘Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø£Ø³Ø±Ø©.");
                } else {
                    alert(`Ø§Ù†ÙØ¬Ø±Øª Ù„ØºÙ…! Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¬ÙˆÙ„Ø©.\nØ§Ù„Ø®Ù„Ø§ÙŠØ§ Ø§Ù„Ù…ÙƒØ´ÙˆÙØ©: ${safeRevealed}\nØ§Ù„Ø®Ù„Ø§ÙŠØ§ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${safeRemaining}\nØ³Ø¬Ù‘Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø£Ø³Ø±Ø©.`);
                }
            }

            function render() {
                grid.innerHTML = "";
                const numberColors = ["", "#3498db", "#2ecc71", "#e74c3c", "#9b59b6", "#f39c12", "#1abc9c", "#000", "#7f8c8d"];
                for (let r = 0; r < rows; r++) {
                    for (let c = 0; c < cols; c++) {
                        const cell = document.createElement('div');
                        cell.style.width = "25px";
                        cell.style.height = "25px";
                        cell.style.display = "flex";
                        cell.style.alignItems = "center";
                        cell.style.justifyContent = "center";
                        cell.style.fontSize = "12px";
                        cell.style.borderRadius = "2px";
                        cell.style.fontWeight = "bold";
                        if (revealed[r][c]) {
                            if (board[r][c] === -1) {
                                cell.style.background = "#e74c3c";
                                cell.textContent = "ğŸ’£";
                            } else {
                                cell.style.background = "#ecf0f1";
                                cell.style.border = "1px solid #bdc3c7";
                                const num = board[r][c];
                                cell.textContent = num === 0 ? "" : num;
                                if (num > 0 && num < numberColors.length) {
                                    cell.style.color = numberColors[num];
                                }
                            }
                        } else {
                            cell.style.background = "#95a5a6";
                            cell.style.border = "2px outset #7f8c8d";
                            cell.style.cursor = "pointer";
                            cell.addEventListener('click', () => {
                                if (running) reveal(r, c);
                            });
                            cell.addEventListener('contextmenu', (e) => {
                                e.preventDefault();
                                if (running && !revealed[r][c]) {
                                    if (cell.textContent === "ğŸš©") {
                                        cell.textContent = "";
                                    } else {
                                        cell.textContent = "ğŸš©";
                                    }
                                }
                            });
                        }
                        grid.appendChild(cell);
                    }
                }
            }

            startBtn.addEventListener('click', () => {
                initBoard();
                running = true;
                render();
            });

            container.appendChild(box);
            container.appendChild(grid);
        }

        // ========== 13) ØªØ¬Ù†Ø¨ Ø§Ù„Ø¹ÙˆØ§Ø¦Ù‚ ==========
        function initObstacleGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø³Ù‡Ù… Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ø¹ÙˆØ§Ø¦Ù‚ Ø§Ù„Ø­Ù…Ø±Ø§Ø¡. ÙƒÙ„Ù…Ø§ ØªÙ‚Ø¯Ù…Øª Ø£ÙƒØ«Ø±ØŒ Ø²Ø§Ø¯Øª Ø§Ù„Ø³Ø±Ø¹Ø©.</div>
            <div style="margin-top:6px;">Ø§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ Ù…Ù† ÙŠØµÙ„ Ù„Ø£Ø¨Ø¹Ø¯ Ù…Ø³Ø§ÙØ©.</div>
            <button class="btn-main" id="obstacleStart">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <div id="obstacleStatus" style="margin-top:6px;">Ø§Ù„Ù…Ø³Ø§ÙØ©: 0</div>
        `;
            const canvas = document.createElement('canvas');
            canvas.width = 300;
            canvas.height = 400;
            canvas.style.border = "2px solid #f1c40f";
            canvas.style.display = "block";
            canvas.style.margin = "10px auto";
            canvas.style.background = "#050815";

            const ctx = canvas.getContext('2d');
            let playerX = 150;
            let obstacles = [];
            let distance = 0;
            let gameLoop = null;
            let running = false;

            const statusEl = box.querySelector('#obstacleStatus');
            const startBtn = box.querySelector('#obstacleStart');

            function draw() {
                ctx.fillStyle = "#050815";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = "#2ecc71";
                ctx.fillRect(playerX - 15, canvas.height - 40, 30, 30);
                ctx.fillStyle = "#e74c3c";
                obstacles.forEach(obs => {
                    ctx.fillRect(obs.x, obs.y, obs.width, obs.height);
                });
            }

            function update() {
                distance++;
                statusEl.textContent = `Ø§Ù„Ù…Ø³Ø§ÙØ©: ${distance}`;
                obstacles.forEach(obs => {
                    obs.y += 2 + distance / 100;
                    if (obs.y > canvas.height) {
                        obstacles.splice(obstacles.indexOf(obs), 1);
                    }
                    if (obs.y + obs.height > canvas.height - 40 && obs.y < canvas.height - 10) {
                        if (playerX - 15 < obs.x + obs.width && playerX + 15 > obs.x) {
                            endGame();
                            return;
                        }
                    }
                });
                if (obstacles.length < 3 && Math.random() < 0.02) {
                    obstacles.push({
                        x: Math.random() * (canvas.width - 60),
                        y: -30,
                        width: 60,
                        height: 30
                    });
                }
                draw();
            }

            function endGame() {
                running = false;
                if (gameLoop) clearInterval(gameLoop);
                alert(`Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¬ÙˆÙ„Ø©! Ø§Ù„Ù…Ø³Ø§ÙØ©: ${distance}. Ø³Ø¬Ù‘Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø£Ø³Ø±Ø©.`);
            }

            startBtn.addEventListener('click', () => {
                if (gameLoop) clearInterval(gameLoop);
                playerX = 150;
                obstacles = [];
                distance = 0;
                running = true;
                statusEl.textContent = `Ø§Ù„Ù…Ø³Ø§ÙØ©: ${distance}`;
                draw();
                gameLoop = setInterval(update, 16);
            });

            document.addEventListener('keydown', (e) => {
                if (!running) return;
                if (e.key === 'ArrowLeft' && playerX > 20) playerX -= 5;
                if (e.key === 'ArrowRight' && playerX < canvas.width - 20) playerX += 5;
            });

            container.appendChild(box);
            container.appendChild(canvas);
        }

        // ========== 14) ØªØªØ§Ø¨Ø¹ Ø§Ù„Ø£Ù„ÙˆØ§Ù† (Ø°Ø§ÙƒØ±Ø©) ==========
        function initColorSequenceGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>Ø´Ø§Ù‡Ø¯ ØªØªØ§Ø¨Ø¹ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…ØªÙˆÙ‡Ø¬Ø© ÙˆÙƒØ±Ø±Ù‡Ø§ Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„ØµØ­ÙŠØ­.</div>
            <div style="margin-top:6px;">Ø§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ Ù…Ù† ÙŠØµÙ„ Ù„Ø£Ø·ÙˆÙ„ ØªØªØ§Ø¨Ø¹.</div>
            <button class="btn-main" id="colorSeqStart">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <div id="colorSeqStatus" style="margin-top:6px;">Ø§Ù„Ù†ØªÙŠØ¬Ø©: 0</div>
        `;
            const grid = document.createElement('div');
            grid.style.display = "grid";
            grid.style.gridTemplateColumns = "repeat(3, 60px)";
            grid.style.gap = "6px";
            grid.style.justifyContent = "center";
            grid.style.marginTop = "10px";

            const colors = ['#e74c3c', '#2ecc71', '#f1c40f', '#3498db', '#9b59b6', '#1abc9c', '#e67e22', '#16a085', '#c0392b'];
            let sequence = [];
            let playerSequence = [];
            let level = 0;
            let showing = false;
            let playing = false;

            const statusEl = box.querySelector('#colorSeqStatus');
            const startBtn = box.querySelector('#colorSeqStart');

            colors.forEach((color, idx) => {
                const btn = document.createElement('button');
                btn.style.width = "60px";
                btn.style.height = "60px";
                btn.style.background = color;
                btn.style.border = "none";
                btn.style.borderRadius = "8px";
                btn.style.cursor = "pointer";
                btn.dataset.index = idx;
                btn.addEventListener('click', () => {
                    if (!playing || showing) return;
                    const idx = Number(btn.dataset.index);
                    playerSequence.push(idx);
                    flashColor(btn, color);
                    checkSequence();
                });
                grid.appendChild(btn);
            });

            function flashColor(btn, color) {
                btn.style.opacity = "0.5";
                setTimeout(() => btn.style.opacity = "1", 200);
            }

            function showSequence() {
                showing = true;
                let idx = 0;
                const timer = setInterval(() => {
                    if (idx >= sequence.length) {
                        clearInterval(timer);
                        showing = false;
                        playerSequence = [];
                        return;
                    }
                    const btnIdx = sequence[idx];
                    const btn = grid.querySelector(`button[data-index="${btnIdx}"]`);
                    flashColor(btn, colors[btnIdx]);
                    idx++;
                }, 300);
            }

            function checkSequence() {
                const lastIdx = playerSequence.length - 1;
                if (playerSequence[lastIdx] !== sequence[lastIdx]) {
                    statusEl.textContent = `Ø®Ø·Ø£! Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: ${level}`;
                    playing = false;
                    alert(`Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¬ÙˆÙ„Ø©! Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${level}. Ø³Ø¬Ù‘Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø£Ø³Ø±Ø©.`);
                    return;
                }
                if (playerSequence.length === sequence.length) {
                    level++;
                    statusEl.textContent = `Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${level}`;
                    sequence.push(Math.floor(Math.random() * colors.length));
                    setTimeout(() => showSequence(), 500);
                }
            }

            startBtn.addEventListener('click', () => {
                sequence = [Math.floor(Math.random() * colors.length)];
                level = 0;
                playerSequence = [];
                playing = true;
                statusEl.textContent = `Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${level}`;
                setTimeout(() => showSequence(), 300);
            });

            container.appendChild(box);
            container.appendChild(grid);
        }

        // ========== 16) ØªØªØ§Ø¨Ø¹ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… (Ø°Ø§ÙƒØ±Ø©) ==========
        function initNumberSequenceGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>Ø´Ø§Ù‡Ø¯ ØªØªØ§Ø¨Ø¹ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…ØªÙˆÙ‡Ø¬Ø© ÙˆÙƒØ±Ø±Ù‡Ø§ Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„ØµØ­ÙŠØ­.</div>
            <div style="margin-top:6px;">Ø§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ Ù…Ù† ÙŠØµÙ„ Ù„Ø£Ø·ÙˆÙ„ ØªØªØ§Ø¨Ø¹.</div>
            <button class="btn-main" id="numSeqStart">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <div id="numSeqStatus" style="margin-top:6px;">Ø§Ù„Ù†ØªÙŠØ¬Ø©: 0</div>
        `;
            const grid = document.createElement('div');
            grid.style.display = "grid";
            grid.style.gridTemplateColumns = "repeat(4, 60px)";
            grid.style.gap = "8px";
            grid.style.justifyContent = "center";
            grid.style.marginTop = "10px";

            let sequence = [];
            let playerSequence = [];
            let level = 0;
            let showing = false;
            let playing = false;

            const statusEl = box.querySelector('#numSeqStatus');
            const startBtn = box.querySelector('#numSeqStart');

            for (let i = 1; i <= 9; i++) {
                const btn = document.createElement('button');
                btn.style.width = "60px";
                btn.style.height = "60px";
                btn.style.background = "#34495e";
                btn.style.border = "none";
                btn.style.borderRadius = "8px";
                btn.style.cursor = "pointer";
                btn.style.fontSize = "20px";
                btn.textContent = i;
                btn.dataset.value = i;
                btn.addEventListener('click', () => {
                    if (!playing || showing) return;
                    const val = Number(btn.dataset.value);
                    playerSequence.push(val);
                    flashNumber(btn);
                    checkSequence();
                });
                grid.appendChild(btn);
            }

            function flashNumber(btn) {
                btn.style.background = "#f1c40f";
                setTimeout(() => btn.style.background = "#34495e", 200);
            }

            function showSequence() {
                showing = true;
                let idx = 0;
                const timer = setInterval(() => {
                    if (idx >= sequence.length) {
                        clearInterval(timer);
                        showing = false;
                        playerSequence = [];
                        return;
                    }
                    const val = sequence[idx];
                    const btn = grid.querySelector(`button[data-value="${val}"]`);
                    flashNumber(btn);
                    idx++;
                }, 300);
            }

            function checkSequence() {
                const lastIdx = playerSequence.length - 1;
                if (playerSequence[lastIdx] !== sequence[lastIdx]) {
                    statusEl.textContent = `Ø®Ø·Ø£! Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: ${level}`;
                    playing = false;
                    alert(`Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¬ÙˆÙ„Ø©! Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${level}. Ø³Ø¬Ù‘Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø£Ø³Ø±Ø©.`);
                    return;
                }
                if (playerSequence.length === sequence.length) {
                    level++;
                    statusEl.textContent = `Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${level}`;
                    sequence.push(Math.floor(Math.random() * 9) + 1);
                    setTimeout(() => showSequence(), 500);
                }
            }

            startBtn.addEventListener('click', () => {
                sequence = [Math.floor(Math.random() * 9) + 1];
                level = 0;
                playerSequence = [];
                playing = true;
                statusEl.textContent = `Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${level}`;
                setTimeout(() => showSequence(), 300);
            });

            container.appendChild(box);
            container.appendChild(grid);
        }

        // ========== 17) Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø±ÙŠØ¹ ==========
        function initSpeedMathGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>Ø£Ø¬Ø¨ Ø¹Ù„Ù‰ Ø£ÙƒØ¨Ø± Ø¹Ø¯Ø¯ Ù…Ù…ÙƒÙ† Ù…Ù† Ø§Ù„Ù…Ø³Ø§Ø¦Ù„ Ø§Ù„Ø­Ø³Ø§Ø¨ÙŠØ© ÙÙŠ 20 Ø«Ø§Ù†ÙŠØ©.</div>
            <div style="margin-top:6px;">Ø§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ Ù…Ù† ÙŠØ­ØµÙ„ Ø¹Ù„Ù‰ Ø£Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø·.</div>
            <button class="btn-main" id="speedMathStart">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <div id="speedMathQuestion" style="margin-top:8px;font-size:24px;">-</div>
            <div style="margin-top:6px;">
                <input id="speedMathAnswer" type="number" placeholder="Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©">
                <button class="btn-green" id="speedMathSubmit">Ø¥Ø±Ø³Ø§Ù„</button>
            </div>
            <div id="speedMathStatus" style="margin-top:6px;">Ø§Ù„Ù†Ù‚Ø§Ø·: 0 | Ø§Ù„ÙˆÙ‚Øª: -</div>
        `;
            let score = 0;
            let timeLeft = 20;
            let currentAnswer = 0;
            let running = false;
            let timerId = null;

            const questionEl = box.querySelector('#speedMathQuestion');
            const answerInput = box.querySelector('#speedMathAnswer');
            const submitBtn = box.querySelector('#speedMathSubmit');
            const statusEl = box.querySelector('#speedMathStatus');
            const startBtn = box.querySelector('#speedMathStart');

            function newQuestion() {
                if (!running) return;
                const a = Math.floor(Math.random() * 50) + 1;
                const b = Math.floor(Math.random() * 50) + 1;
                const op = Math.random() < 0.5 ? '+' : '-';
                if (op === '+') {
                    currentAnswer = a + b;
                    questionEl.textContent = `${a} + ${b} = ?`;
                } else {
                    currentAnswer = Math.max(a, b) - Math.min(a, b);
                    questionEl.textContent = `${Math.max(a, b)} - ${Math.min(a, b)} = ?`;
                }
            }

            function endGame() {
                running = false;
                if (timerId) clearInterval(timerId);
                answerInput.disabled = true;
                submitBtn.disabled = true;
                if (!isMiniGameOverlayOpen()) return;
                alert(`Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}. Ø³Ø¬Ù‘Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø£Ø³Ø±Ø©.`);
            }

            submitBtn.addEventListener('click', () => {
                if (!running) return;
                const answer = Number(answerInput.value);
                if (answer === currentAnswer) {
                    score++;
                }
                answerInput.value = "";
                if (running) newQuestion();
            });

            answerInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && running) {
                    submitBtn.click();
                }
            });

            startBtn.addEventListener('click', () => {
                if (timerId) clearInterval(timerId);
                score = 0;
                timeLeft = 20;
                running = true;
                answerInput.disabled = false;
                submitBtn.disabled = false;
                answerInput.value = "";
                newQuestion();
                answerInput.focus();
                timerId = setInterval(() => {
                    timeLeft--;
                    statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                    if (timeLeft <= 0) {
                        endGame();
                    }
                }, 1000);
                registerMiniGameTimer(timerId);
            });

            container.appendChild(box);
        }

        // ========== 18) ØªØ¯Ø±ÙŠØ¨ Ø§Ù„ØªØµÙˆÙŠØ¨ ==========
        function initAimTrainerGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙƒØ¨Ø± Ø¹Ø¯Ø¯ Ù…Ù…ÙƒÙ† Ù…Ù† Ø§Ù„Ø£Ù‡Ø¯Ø§Ù ÙÙŠ 15 Ø«Ø§Ù†ÙŠØ©.</div>
            <div style="margin-top:6px;">Ø§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ Ù…Ù† ÙŠØ­ØµÙ„ Ø¹Ù„Ù‰ Ø£Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø·.</div>
            <button class="btn-main" id="aimStart">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <div id="aimStatus" style="margin-top:6px;">Ø§Ù„Ù†Ù‚Ø§Ø·: 0 | Ø§Ù„ÙˆÙ‚Øª: -</div>
        `;
            const canvas = document.createElement('canvas');
            canvas.width = 400;
            canvas.height = 400;
            canvas.style.border = "2px solid #f1c40f";
            canvas.style.display = "block";
            canvas.style.margin = "10px auto";
            canvas.style.background = "#050815";
            canvas.style.cursor = "crosshair";

            const ctx = canvas.getContext('2d');
            let targets = [];
            let score = 0;
            let timeLeft = 15;
            let gameLoop = null;
            let timerId = null;
            let running = false;

            const statusEl = box.querySelector('#aimStatus');
            const startBtn = box.querySelector('#aimStart');

            function spawnTarget() {
                targets.push({
                    x: Math.random() * (canvas.width - 30),
                    y: Math.random() * (canvas.height - 30),
                    size: 20 + Math.random() * 15
                });
            }

            function draw() {
                ctx.fillStyle = "#050815";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = "#e74c3c";
                targets.forEach(target => {
                    ctx.beginPath();
                    ctx.arc(target.x + target.size/2, target.y + target.size/2, target.size/2, 0, Math.PI * 2);
                    ctx.fill();
                });
            }

            canvas.addEventListener('click', (e) => {
                if (!running) return;
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                targets.forEach((target, idx) => {
                    const centerX = target.x + target.size/2;
                    const centerY = target.y + target.size/2;
                    const dist = Math.sqrt((x - centerX)**2 + (y - centerY)**2);
                    if (dist <= target.size/2) {
                        targets.splice(idx, 1);
                        score++;
                        statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                    }
                });
            });

            startBtn.addEventListener('click', () => {
                if (gameLoop) clearInterval(gameLoop);
                if (timerId) clearInterval(timerId);
                targets = [];
                score = 0;
                timeLeft = 15;
                running = true;
                statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                spawnTarget();
                draw();
                gameLoop = setInterval(() => {
                    if (targets.length < 5) spawnTarget();
                    draw();
                }, 500);
                timerId = setInterval(() => {
                    timeLeft--;
                    statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                    if (timeLeft <= 0) {
                        running = false;
                        clearInterval(gameLoop);
                        clearInterval(timerId);
                        if (!isMiniGameOverlayOpen()) return;
                        alert(`Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}. Ø³Ø¬Ù‘Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø£Ø³Ø±Ø©.`);
                    }
                }, 1000);
                registerMiniGameTimer(gameLoop);
                registerMiniGameTimer(timerId);
            });

            container.appendChild(box);
            container.appendChild(canvas);
        }

        // ========== 18) Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¥ÙŠÙ‚Ø§Ø¹ ==========
        function initRhythmTapGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>Ø§Ù†Ù‚Ø± Ø¹Ù†Ø¯Ù…Ø§ ÙŠØµÙ„ Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ø£ØµÙØ± Ø¥Ù„Ù‰ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø£Ø®Ø¶Ø±. Ø§Ù„ØªÙˆÙ‚ÙŠØª Ø§Ù„Ø¯Ù‚ÙŠÙ‚ ÙŠØ¹Ø·ÙŠ Ù†Ù‚Ø§Ø· Ø£ÙƒØ«Ø±.</div>
            <div style="margin-top:6px;">Ù„Ø¯ÙŠÙƒ 30 Ø«Ø§Ù†ÙŠØ©. Ø§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ Ù…Ù† ÙŠØ­ØµÙ„ Ø¹Ù„Ù‰ Ø£Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø·.</div>
            <button class="btn-main" id="rhythmStart">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <div id="rhythmStatus" style="margin-top:6px;">Ø§Ù„Ù†Ù‚Ø§Ø·: 0 | Ø§Ù„ÙˆÙ‚Øª: -</div>
        `;
            const canvas = document.createElement('canvas');
            canvas.width = 400;
            canvas.height = 100;
            canvas.style.border = "2px solid #f1c40f";
            canvas.style.display = "block";
            canvas.style.margin = "10px auto";
            canvas.style.background = "#050815";
            canvas.style.cursor = "pointer";

            const ctx = canvas.getContext('2d');
            let position = 0;
            let targetX = 200;
            let score = 0;
            let timeLeft = 30;
            let gameLoop = null;
            let timerId = null;
            let running = false;

            const statusEl = box.querySelector('#rhythmStatus');
            const startBtn = box.querySelector('#rhythmStart');

            function draw() {
                ctx.fillStyle = "#050815";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = "#2ecc71";
                ctx.fillRect(targetX - 8, 0, 16, canvas.height);
                ctx.fillStyle = "#f1c40f";
                ctx.fillRect(position - 4, 0, 8, canvas.height);
            }

            function update() {
                if (!running) return;
                position += 4;
                if (position >= canvas.width) {
                    position = 0;
                    targetX = 50 + Math.random() * (canvas.width - 100);
                }
                draw();
            }

            function handleClick() {
                if (!running) return;
                const dist = Math.abs(position - targetX);
                if (dist < 20) {
                    const points = Math.max(1, 20 - Math.floor(dist));
                    score += points;
                    statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                    position = 0;
                    targetX = 50 + Math.random() * (canvas.width - 100);
                    draw();
                } else {
                    score = Math.max(0, score - 2);
                    statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                }
            }

            function endGame() {
                running = false;
                if (gameLoop) clearInterval(gameLoop);
                if (timerId) clearInterval(timerId);
                if (!isMiniGameOverlayOpen()) return;
                alert(`Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}. Ø³Ø¬Ù‘Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø£Ø³Ø±Ø©.`);
            }

            canvas.addEventListener('click', handleClick);
            canvas.addEventListener('touchstart', (e) => {
                e.preventDefault();
                handleClick();
            });
            document.addEventListener('keydown', (e) => {
                if (e.key === ' ') {
                    e.preventDefault();
                    handleClick();
                }
            });

            startBtn.addEventListener('click', () => {
                if (gameLoop) clearInterval(gameLoop);
                if (timerId) clearInterval(timerId);
                position = 0;
                targetX = 200;
                score = 0;
                timeLeft = 30;
                running = true;
                statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                draw();
                gameLoop = setInterval(update, 16);
                timerId = setInterval(() => {
                    timeLeft--;
                    statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                    if (timeLeft <= 0) {
                        endGame();
                    }
                }, 1000);
                registerMiniGameTimer(gameLoop);
                registerMiniGameTimer(timerId);
            });

            container.appendChild(box);
            container.appendChild(canvas);
        }

        // ========== 20) ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…ÙƒØ¹Ø¨Ø§Øª ==========
        function initStackBlocksGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>Ø§Ø¶ØºØ· Ø§Ù„Ù…Ø³Ø§ÙØ© ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…ÙƒØ¹Ø¨Ø§Øª ÙÙˆÙ‚ Ø¨Ø¹Ø¶Ù‡Ø§.</div>
            <div style="margin-top:6px;">Ø§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ Ù…Ù† ÙŠØ¨Ù†ÙŠ Ø£Ø¹Ù„Ù‰ Ø¨Ø±Ø¬.</div>
            <button class="btn-main" id="stackStart">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <div id="stackStatus" style="margin-top:6px;">Ø§Ù„Ø§Ø±ØªÙØ§Ø¹: 0</div>
        `;
            const canvas = document.createElement('canvas');
            canvas.width = 300;
            canvas.height = 400;
            canvas.style.border = "2px solid #f1c40f";
            canvas.style.display = "block";
            canvas.style.margin = "10px auto";
            canvas.style.background = "#050815";

            const ctx = canvas.getContext('2d');
            let blocks = [];
            let currentX = 150;
            let currentDir = 1;
            let height = 0;
            let gameLoop = null;
            let running = false;

            const statusEl = box.querySelector('#stackStatus');
            const startBtn = box.querySelector('#stackStart');

            function draw() {
                ctx.fillStyle = "#050815";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                const colors = ['#f1c40f', '#2ecc71', '#3498db', '#9b59b6', '#e74c3c', '#1abc9c', '#e67e22'];
                blocks.forEach((block, idx) => {
                    ctx.fillStyle = colors[idx % colors.length];
                    ctx.fillRect(block.x - block.width/2, block.y, block.width, 20);
                    ctx.strokeStyle = "#fff";
                    ctx.lineWidth = 1;
                    ctx.strokeRect(block.x - block.width/2, block.y, block.width, 20);
                });
                ctx.fillStyle = "#2ecc71";
                ctx.fillRect(currentX - 30, canvas.height - 40, 60, 20);
                ctx.strokeStyle = "#fff";
                ctx.lineWidth = 2;
                ctx.strokeRect(currentX - 30, canvas.height - 40, 60, 20);
            }

            function update() {
                currentX += currentDir * 2;
                if (currentX <= 30 || currentX >= canvas.width - 30) {
                    currentDir = -currentDir;
                }
                draw();
            }

            function dropBlock() {
                if (!running) return;
                const lastBlock = blocks[blocks.length - 1];
                let newWidth = 60;
                if (lastBlock) {
                    const diff = Math.abs(currentX - lastBlock.x);
                    if (diff > lastBlock.width/2) {
                        endGame();
                        return;
                    }
                    newWidth = Math.min(60, lastBlock.width - Math.abs(currentX - lastBlock.x) * 2);
                    if (newWidth < 10) {
                        endGame();
                        return;
                    }
                }
                blocks.push({x: currentX, y: canvas.height - 40 - height * 20, width: newWidth});
                height++;
                statusEl.textContent = `Ø§Ù„Ø§Ø±ØªÙØ§Ø¹: ${height}`;
            }

            function endGame() {
                running = false;
                if (gameLoop) clearInterval(gameLoop);
                alert(`Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¬ÙˆÙ„Ø©! Ø§Ù„Ø§Ø±ØªÙØ§Ø¹: ${height}. Ø³Ø¬Ù‘Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø£Ø³Ø±Ø©.`);
            }

            startBtn.addEventListener('click', () => {
                if (gameLoop) clearInterval(gameLoop);
                blocks = [];
                currentX = 150;
                currentDir = 1;
                height = 0;
                running = true;
                statusEl.textContent = `Ø§Ù„Ø§Ø±ØªÙØ§Ø¹: ${height}`;
                draw();
                gameLoop = setInterval(update, 16);
            });

            document.addEventListener('keydown', (e) => {
                if (e.key === ' ') dropBlock();
            });

            container.appendChild(box);
            container.appendChild(canvas);
        }

        // ========== 21) Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ù†Ù…Ø· ==========
        function initPatternMatchGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>Ø´Ø§Ù‡Ø¯ Ø§Ù„Ù†Ù…Ø· Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶ ÙˆØ§Ø®ØªØ± Ø§Ù„Ù†Ù…Ø· Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù‡ Ù…Ù† Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª.</div>
            <div style="margin-top:6px;">Ù„Ø¯ÙŠÙƒ 15 Ø«Ø§Ù†ÙŠØ© Ù„Ø¥ÙŠØ¬Ø§Ø¯ Ø£ÙƒØ¨Ø± Ø¹Ø¯Ø¯ Ù…Ù† Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØµØ­ÙŠØ­Ø©.</div>
            <button class="btn-main" id="patternStart">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <div id="patternQuestion" style="margin-top:8px;"></div>
            <div id="patternOptions" style="margin-top:8px;"></div>
            <div id="patternStatus" style="margin-top:6px;">Ø§Ù„Ù†Ù‚Ø§Ø·: 0 | Ø§Ù„ÙˆÙ‚Øª: -</div>
        `;
            let score = 0;
            let currentPattern = [];
            let correctAnswer = 0;
            let running = false;
            let timeLeft = 15;
            let timerId = null;

            const questionEl = box.querySelector('#patternQuestion');
            const optionsEl = box.querySelector('#patternOptions');
            const statusEl = box.querySelector('#patternStatus');
            const startBtn = box.querySelector('#patternStart');

            function generatePattern() {
                const size = 3;
                currentPattern = [];
                for (let i = 0; i < size * size; i++) {
                    currentPattern.push(Math.random() < 0.5);
                }
                correctAnswer = Math.floor(Math.random() * 6);
            }

            function arraysEqual(a, b) {
                if (a.length !== b.length) return false;
                for (let i = 0; i < a.length; i++) {
                    if (a[i] !== b[i]) return false;
                }
                return true;
            }

            function render() {
                questionEl.innerHTML = "<div>Ø§Ù„Ù†Ù…Ø·:</div>";
                const patternGrid = document.createElement('div');
                patternGrid.style.display = "grid";
                patternGrid.style.gridTemplateColumns = "repeat(3, 50px)";
                patternGrid.style.gap = "6px";
                patternGrid.style.marginTop = "4px";
                patternGrid.style.justifyContent = "center";
                currentPattern.forEach((val, idx) => {
                    const cell = document.createElement('div');
                    cell.style.width = "50px";
                    cell.style.height = "50px";
                    cell.style.background = val ? "#f1c40f" : "#34495e";
                    cell.style.border = "2px solid #2c3e50";
                    cell.style.borderRadius = "4px";
                    patternGrid.appendChild(cell);
                });
                questionEl.appendChild(patternGrid);

                optionsEl.innerHTML = "";
                optionsEl.style.display = "grid";
                optionsEl.style.gridTemplateColumns = "repeat(3, 1fr)";
                optionsEl.style.gap = "8px";
                optionsEl.style.marginTop = "10px";
                const usedPatterns = [];
                for (let i = 0; i < 6; i++) {
                    const option = document.createElement('button');
                    option.className = "btn-dark";
                    option.style.padding = "8px";
                    option.style.cursor = "pointer";
                    let optionPattern;
                    if (i === correctAnswer) {
                        optionPattern = [...currentPattern];
                    } else {
                        do {
                            optionPattern = Array(9).fill().map(() => Math.random() < 0.5);
                        } while (arraysEqual(optionPattern, currentPattern) || usedPatterns.some(p => arraysEqual(p, optionPattern)));
                        usedPatterns.push(optionPattern);
                    }
                    const optGrid = document.createElement('div');
                    optGrid.style.display = "grid";
                    optGrid.style.gridTemplateColumns = "repeat(3, 30px)";
                    optGrid.style.gap = "3px";
                    optGrid.style.justifyContent = "center";
                    optionPattern.forEach(val => {
                        const cell = document.createElement('div');
                        cell.style.width = "30px";
                        cell.style.height = "30px";
                        cell.style.background = val ? "#f1c40f" : "#34495e";
                        cell.style.border = "1px solid #2c3e50";
                        cell.style.borderRadius = "3px";
                        optGrid.appendChild(cell);
                    });
                    option.appendChild(optGrid);
                    option.addEventListener('click', () => {
                        if (!running) return;
                        if (i === correctAnswer) {
                            score++;
                            statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                            generatePattern();
                            render();
                        } else {
                            statusEl.textContent = `Ø®Ø·Ø£! Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                        }
                    });
                    optionsEl.appendChild(option);
                }
            }

            function endGame() {
                running = false;
                if (timerId) clearInterval(timerId);
                if (!isMiniGameOverlayOpen()) return;
                alert(`Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}. Ø³Ø¬Ù‘Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø£Ø³Ø±Ø©.`);
            }

            startBtn.addEventListener('click', () => {
                if (timerId) clearInterval(timerId);
                score = 0;
                timeLeft = 15;
                running = true;
                statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                generatePattern();
                render();
                timerId = setInterval(() => {
                    timeLeft--;
                    statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                    if (timeLeft <= 0) {
                        endGame();
                    }
                }, 1000);
                registerMiniGameTimer(timerId);
            });

            container.appendChild(box);
        }

        // ========== 21) Ù„Ø¹Ø¨Ø© Ø§Ù„Ø¹Ø¯ Ø§Ù„Ø³Ø±ÙŠØ¹ ==========
        function initCountingGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>Ø¹Ø¯ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ© Ø¨Ø³Ø±Ø¹Ø©. ÙƒÙ„ Ø¬ÙˆÙ„Ø© ØªØ¸Ù‡Ø± Ø´Ø¨ÙƒØ© Ø¬Ø¯ÙŠØ¯Ø©.</div>
            <div style="margin-top:6px;">Ù„Ø¯ÙŠÙƒ 20 Ø«Ø§Ù†ÙŠØ© Ù„Ø¥ÙŠØ¬Ø§Ø¯ Ø£ÙƒØ¨Ø± Ø¹Ø¯Ø¯ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©.</div>
            <button class="btn-main" id="countingStart">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <div id="countingQuestion" style="margin-top:8px;font-size:20px;">-</div>
            <div style="margin-top:6px;">
                <input id="countingAnswer" type="number" placeholder="Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©">
                <button class="btn-green" id="countingSubmit">Ø¥Ø±Ø³Ø§Ù„</button>
            </div>
            <div id="countingStatus" style="margin-top:6px;">Ø§Ù„Ù†Ù‚Ø§Ø·: 0 | Ø§Ù„ÙˆÙ‚Øª: -</div>
        `;
            
            const grid = document.createElement('div');
            grid.style.display = "grid";
            grid.style.gridTemplateColumns = "repeat(4, 50px)";
            grid.style.gap = "6px";
            grid.style.justifyContent = "center";
            grid.style.marginTop = "10px";
            
            let score = 0;
            let timeLeft = 20;
            let currentTarget = null;
            let currentAnswer = 0;
            let running = false;
            let timerId = null;
            let items = [];
            
            const questionEl = box.querySelector('#countingQuestion');
            const answerInput = box.querySelector('#countingAnswer');
            const submitBtn = box.querySelector('#countingSubmit');
            const statusEl = box.querySelector('#countingStatus');
            const startBtn = box.querySelector('#countingStart');
            
            const symbols = ['1', '2', '3', '4', '5', '6', '7', '8', '9', 'ğŸ”´', 'ğŸŸ¢', 'ğŸ”µ', 'ğŸŸ¡', 'âš«', 'âšª'];
            
            function generateGrid() {
                grid.innerHTML = "";
                items = [];
                const size = 16;
                const symbolsToUse = symbols.slice(0, 8);
                
                // Ø§Ø®ØªÙŠØ§Ø± Ù‡Ø¯Ù Ø¹Ø´ÙˆØ§Ø¦ÙŠ
                currentTarget = symbolsToUse[Math.floor(Math.random() * symbolsToUse.length)];
                currentAnswer = 0;
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø´Ø¨ÙƒØ©
                for (let i = 0; i < size; i++) {
                    const symbol = symbolsToUse[Math.floor(Math.random() * symbolsToUse.length)];
                    items.push(symbol);
                    
                    const cell = document.createElement('div');
                    cell.style.width = "40px";
                    cell.style.height = "40px";
                    cell.style.background = "#34495e";
                    cell.style.border = "2px solid #2c3e50";
                    cell.style.borderRadius = "4px";
                    cell.style.display = "flex";
                    cell.style.alignItems = "center";
                    cell.style.justifyContent = "center";
                    cell.style.fontSize = symbol.length > 1 ? "20px" : "18px";
                    cell.style.fontWeight = "bold";
                    cell.style.color = "#ecf0f1";
                    cell.textContent = symbol;
                    grid.appendChild(cell);
                    
                    if (symbol === currentTarget) {
                        currentAnswer++;
                    }
                }
                
                questionEl.textContent = `ÙƒÙ… Ù…Ø±Ø© ÙŠØ¸Ù‡Ø± "${currentTarget}" ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ©ØŸ`;
            }
            
            function endGame() {
                running = false;
                if (timerId) clearInterval(timerId);
                answerInput.disabled = true;
                submitBtn.disabled = true;
                if (!isMiniGameOverlayOpen()) return;
                alert(`Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}. Ø³Ø¬Ù‘Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø£Ø³Ø±Ø©.`);
            }
            
            submitBtn.addEventListener('click', () => {
                if (!running) return;
                const answer = Number(answerInput.value);
                if (answer === currentAnswer) {
                    score++;
                    statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                }
                answerInput.value = "";
                if (running) {
                    generateGrid();
                    answerInput.focus();
                }
            });
            
            answerInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && running) {
                    submitBtn.click();
                }
            });
            
            startBtn.addEventListener('click', () => {
                if (timerId) clearInterval(timerId);
                score = 0;
                timeLeft = 20;
                running = true;
                answerInput.disabled = false;
                submitBtn.disabled = false;
                answerInput.value = "";
                generateGrid();
                answerInput.focus();
                timerId = setInterval(() => {
                    timeLeft--;
                    statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                    if (timeLeft <= 0) {
                        endGame();
                    }
                }, 1000);
                registerMiniGameTimer(timerId);
            });
            
            container.appendChild(box);
            container.appendChild(grid);
        }

        // ØªØ´ØºÙŠÙ„ Ø£ÙˆÙ„ÙŠ
        renderAll();
        populateMiniGameSelect();
    </script>

    <div class="credit-footer">
        <span class="credit-by">ØµÙ†Ø¹ Ø¨ÙˆØ§Ø³Ø·Ø© Ù…Ù€Ù€Ø¯Ø§Ø¯ â€” 0534349939</span>
        <span class="credit-rights">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</span>
    </div>
</body>

</html>