<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <title>Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø³Ø± - Ù…Ù† Ø³ÙŠØ±Ø¨Ø­ Ø§Ù„Ù…Ù„ÙŠÙˆÙ†</title>
    <style>
        body {
            margin: 0;
            font-family: "Tahoma", Arial, sans-serif;
            background: radial-gradient(circle at top, #243b6b 0, #060818 55%, #02030a 100%);
            color: #f5f5f5;
        }

        header {
            text-align: center;
            padding: 20px 10px;
            background: linear-gradient(180deg, #1b2a4a, #101526);
            border-bottom: 2px solid #f1c40f;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        #gameTitle {
            font-size: 22px;
            font-weight: bold;
            color: #f1c40f;
            outline: none;
            cursor: text;
        }

        header small {
            display: block;
            font-size: 11px;
            color: #bdc3c7;
            margin-top: 4px;
        }

        .container {
            width: 95%;
            max-width: 1200px;
            margin: 15px auto 40px auto;
        }

        section {
            background: rgba(10, 16, 36, 0.92);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(241, 196, 15, 0.4);
            box-shadow: 0 0 12px rgba(0, 0, 0, 0.6);
        }

        h2 {
            margin-top: 0;
            color: #f1c40f;
            font-size: 18px;
        }

        input,
        select,
        button {
            padding: 7px 9px;
            margin: 4px;
            border-radius: 6px;
            border: 1px solid #34495e;
            font-family: inherit;
            font-size: 14px;
        }

        input,
        select {
            background: #0c1224;
            color: #ecf0f1;
        }

        input::placeholder {
            color: #7f8c8d;
        }

        button {
            cursor: pointer;
            border: none;
            color: #fff;
            font-weight: bold;
            transition: transform 0.08s ease, box-shadow 0.08s ease, opacity 0.1s ease;
        }

        button:active {
            transform: scale(0.96);
            box-shadow: 0 0 4px rgba(0, 0, 0, 0.6) inset;
            opacity: 0.9;
        }

        .btn-main {
            background: linear-gradient(135deg, #f1c40f, #f39c12);
        }

        .btn-green {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }

        .btn-red {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .btn-blue {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        .btn-purple {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
        }

        .btn-dark {
            background: linear-gradient(135deg, #34495e, #2c3e50);
        }

        .flex-row {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
        }

        .flex-row>* {
            margin-bottom: 5px;
        }

        .families-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .family-card {
            background: radial-gradient(circle at top, #1e2a52 0, #050815 80%);
            border-radius: 12px;
            padding: 10px;
            width: 220px;
            border: 1px solid rgba(241, 196, 15, 0.45);
            box-shadow: 0 0 8px rgba(0, 0, 0, 0.9);
            position: relative;
        }

        .family-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }

        .family-name {
            font-weight: bold;
            font-size: 16px;
            color: #f1c40f;
        }

        .family-rank {
            font-size: 11px;
            color: #bdc3c7;
        }

        .points-row {
            font-size: 13px;
            margin: 2px 0;
        }

        .label {
            color: #bdc3c7;
        }

        .value {
            font-weight: bold;
            color: #ecf0f1;
        }

        .family-buttons {
            margin-top: 6px;
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            justify-content: center;
        }

        .family-buttons button {
            font-size: 11px;
            padding: 4px 6px;
        }

        .leader {
            border-color: #2ecc71;
            box-shadow: 0 0 14px rgba(46, 204, 113, 0.7);
        }

        .history-box {
            max-height: 220px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.4);
            padding: 8px;
            border-radius: 8px;
            font-size: 13px;
        }

        .history-entry {
            margin-bottom: 4px;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.08);
            padding-bottom: 3px;
        }

        .history-entry span.time {
            color: #7f8c8d;
            font-size: 11px;
            margin-right: 4px;
        }

        .top-bar {
            font-size: 14px;
            margin-bottom: 8px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .top-pill {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 999px;
            padding: 5px 10px;
            border: 1px solid rgba(241, 196, 15, 0.4);
        }

        /* Ø£ÙˆÙØ±Ù„Ø§ÙŠ Ø§Ù„Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ…Ø² */
        .overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
        }

        .hidden {
            display: none;
        }

        .mini-panel {
            background: #0b1024;
            border-radius: 14px;
            padding: 15px;
            width: 95%;
            max-width: 800px;
            max-height: 90vh;
            border: 1px solid #f1c40f;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.85);
            display: flex;
            flex-direction: column;
        }

        .mini-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .mini-title {
            font-size: 18px;
            color: #f1c40f;
        }

        .mini-body {
            flex: 1;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 10px;
            font-size: 14px;
        }

        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ù„Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ */
        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 60px);
            gap: 8px;
            justify-content: center;
            margin-top: 10px;
        }

        .memory-card {
            width: 60px;
            height: 60px;
            background: #1e2a52;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 26px;
            cursor: pointer;
            user-select: none;
        }

        .memory-card.flipped {
            background: #f1c40f;
            color: #000;
        }

        .memory-card.matched {
            background: #2ecc71;
            color: #000;
            cursor: default;
        }

        .reaction-box {
            text-align: center;
            padding: 15px;
        }

        .reaction-area {
            margin-top: 15px;
            padding: 25px;
            border-radius: 10px;
            background: #1e2a52;
            cursor: pointer;
        }

        .mole-grid {
            display: grid;
            grid-template-columns: repeat(3, 70px);
            gap: 8px;
            justify-content: center;
            margin-top: 10px;
        }

        .mole-cell {
            width: 70px;
            height: 70px;
            background: #1e2a52;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            user-select: none;
            font-size: 26px;
        }

        .mole-cell.mole {
            background: #27ae60;
        }

        .color-grid {
            display: grid;
            grid-template-columns: repeat(4, 40px);
            gap: 6px;
            justify-content: center;
            margin-top: 10px;
        }

        .color-cell {
            width: 40px;
            height: 40px;
            border-radius: 6px;
            cursor: pointer;
        }

        .cup-row {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }

        .cup {
            width: 60px;
            height: 70px;
            border-radius: 6px;
            background: #1e2a52;
            border: 2px solid #f1c40f;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            font-size: 22px;
        }

        .typing-box textarea {
            width: 100%;
            min-height: 80px;
            margin-top: 8px;
            background: #050815;
            color: #ecf0f1;
            border-radius: 8px;
            padding: 8px;
            border: 1px solid #34495e;
        }

        @media (max-width: 600px) {
            .family-card {
                width: 100%;
            }
        }
    </style>
</head>

<body>

    <header>
        <div id="gameTitle" contenteditable="true">
            Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø³Ø± - Ù…Ù† Ø³ÙŠØ±Ø¨Ø­ Ø§Ù„Ù…Ù„ÙŠÙˆÙ†
        </div>
        <small>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù„ØªØºÙŠÙŠØ± Ø§Ø³Ù… Ø§Ù„Ù„Ø¹Ø¨Ø©</small>
    </header>

    <div class="container">

        <!-- Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø³Ø± -->
        <section>
            <h2>Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø³Ø±</h2>
            <div class="flex-row">
                <input id="familyNameInput" type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ø£Ø³Ø±Ø©">
                <input id="startPointsInput" type="number" placeholder="Ù†Ù‚Ø§Ø· Ø¨Ø¯Ø§ÙŠØ© (Ù…Ø«Ù„Ø§Ù‹ 0)">
                <button class="btn-main" onclick="addFamily()">Ø¥Ø¶Ø§ÙØ© Ø£Ø³Ø±Ø©</button>
            </div>

            <div class="flex-row" style="margin-top:8px;">
                <input id="autoCountInput" type="number" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø± (Ù„Ø¥Ù†Ø´Ø§Ø¡ ØªÙ„Ù‚Ø§Ø¦ÙŠ)">
                <button class="btn-blue" onclick="createAutoFamilies()">Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø³Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ (Ø£Ø³Ø±Ø© 1ØŒ Ø£Ø³Ø±Ø© 2 ...)</button>
                <button class="btn-red" onclick="resetAllFamilies()">Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· ÙƒÙ„ Ø§Ù„Ø£Ø³Ø±</button>
            </div>
        </section>

        <!-- Ù…Ù„Ø®Øµ Ø£Ø¹Ù„Ù‰ -->
        <section>
            <h2>Ù…Ù„Ø®Øµ Ø³Ø±ÙŠØ¹</h2>
            <div class="top-bar" id="summaryBar"></div>
        </section>

        <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø³Ø± -->
        <section>
            <h2>Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø³Ø±</h2>
            <div class="families-grid" id="familiesGrid"></div>
        </section>

        <!-- Ø§Ù„Ø¨ÙŠÙ†ÙŠØ§Øª ÙˆØ§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø§Ø· -->
        <section>
            <h2>Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø§Ø·</h2>

            <div class="flex-row">
                <select id="targetFamilySelect1"></select>
                <button class="btn-red" onclick="zeroWallet()">ØªØµÙÙŠØ± Ø£Ø³Ø±Ø© (Ø§Ù„Ù…Ø­ÙØ¸Ø© ÙÙ‚Ø·)</button>

                <select id="targetFamilySelect2"></select>
                <button class="btn-dark" onclick="zeroAll()">ØªØµÙÙŠØ± Ø£Ø³Ø±Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</button>

                <select id="targetFamilySelect3"></select>
                <button class="btn-purple" onclick="quadrupleWallet()">ØªØ¶Ø¹ÙŠÙ Ã—4 (Ø§Ù„Ù…Ø­ÙØ¸Ø©)</button>
            </div>

            <div class="flex-row" style="margin-top:8px;">
                <select id="fromFamilySelect"></select>
                <select id="toFamilySelect"></select>
                <input id="transferAmountInput" type="number" placeholder="ÙƒÙ… Ù†Ù‚Ø·Ø© ØªÙ†Ù‚Ù„ØŸ">
                <button class="btn-blue" onclick="transferPoints()">Ù†Ù‚Ù„ / Ø³Ø±Ù‚Ø© Ù†Ù‚Ø§Ø· Ø¨ÙŠÙ† Ø§Ù„Ø£Ø³Ø±</button>
            </div>

            <div class="flex-row" style="margin-top:8px;">
                <select id="bankFamilySelect"></select>
                <button class="btn-green" onclick="depositAllToBank()">Ø¥ÙŠØ¯Ø§Ø¹ ÙƒÙ„ Ø§Ù„Ù…Ø­ÙØ¸Ø© ÙÙŠ Ø§Ù„Ø¨Ù†Ùƒ</button>
            </div>
        </section>

        <!-- Ø§Ù„Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ…Ø² (Ø§Ù„Ø¨ÙŠÙ†ÙŠØ§Øª Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©) -->
        <section>
            <h2>Ø§Ù„Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ…Ø² (Ø§Ù„Ø¨ÙŠÙ†ÙŠØ§Øª)</h2>
            <div class="flex-row">
                <select id="miniGameSelect"></select>
                <button class="btn-main" onclick="startSelectedMiniGame()">ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ… Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©</button>
                <button class="btn-blue" onclick="startRandomMiniGame()">Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ… Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© ğŸ®</button>
            </div>
            <small style="color:#bdc3c7;">
                Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ…ØŒ Ø§Ø®ØªØ± Ø§Ù„Ø£Ø³Ø±Ø© Ø§Ù„ÙØ§Ø¦Ø²Ø© Ù…Ù† Ø§Ù„ÙƒØ±ÙˆØª Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰ ÙˆØ¹Ø¯Ù‘Ù„ Ù†Ù‚Ø§Ø·Ù‡Ø§ ÙŠØ¯ÙˆÙŠÙ‹Ø§.
            </small>
        </section>

        <!-- Ø§Ù„Ø³Ø¬Ù„ -->
        <section>
            <h2>Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«</h2>
            <div class="history-box" id="historyBox"></div>
        </section>

    </div>

    <!-- Ø£ÙˆÙØ±Ù„Ø§ÙŠ Ø§Ù„Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ…Ø² -->
    <div id="miniGameOverlay" class="overlay hidden">
        <div class="mini-panel">
            <div class="mini-header">
                <div id="miniGameTitle" class="mini-title">Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ…</div>
                <div>
                    <button class="btn-dark" onclick="closeMiniGame()">Ø¥ØºÙ„Ø§Ù‚ Ã—</button>
                </div>
            </div>
            <div id="miniGameBody" class="mini-body">
                <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ… ÙŠØªÙ… Ø­Ù‚Ù†Ù‡ Ù‡Ù†Ø§ -->
            </div>
        </div>
    </div>

    <script>
        // =====================================
        // Ù†Ù…ÙˆØ°Ø¬ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø±
        // =====================================
        let families = [];
        let familyIdCounter = 1;

        function addFamily() {
            const nameInput = document.getElementById('familyNameInput');
            const startPointsInput = document.getElementById('startPointsInput');

            let name = nameInput.value.trim();
            let startPoints = Number(startPointsInput.value);

            if (!name) {
                alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø£Ø³Ø±Ø©");
                return;
            }
            if (isNaN(startPoints)) startPoints = 0;

            families.push({
                id: familyIdCounter++,
                name: name,
                wallet: startPoints,
                bank: 0
            });

            nameInput.value = "";
            startPointsInput.value = "";
            renderAll();
            log(`ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø³Ø±Ø© Â«${name}Â» Ø¨Ø±ØµÙŠØ¯ Ø¨Ø¯Ø§ÙŠØ© ${startPoints} Ù†Ù‚Ø·Ø©`);
        }

        function createAutoFamilies() {
            const countInput = document.getElementById('autoCountInput');
            const count = Number(countInput.value);

            if (!count || count <= 0) {
                alert("Ø£Ø¯Ø®Ù„ Ø¹Ø¯Ø¯ Ø£Ø³Ø± ØµØ­ÙŠØ­");
                return;
            }

            families = [];
            familyIdCounter = 1;

            for (let i = 1; i <= count; i++) {
                families.push({
                    id: familyIdCounter++,
                    name: "Ø£Ø³Ø±Ø© " + i,
                    wallet: 0,
                    bank: 0
                });
            }

            countInput.value = "";
            renderAll();
            log(`ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ${count} Ø£Ø³Ø±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§`);
        }

        function resetAllFamilies() {
            if (!confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø± Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ØŸ")) return;
            families.forEach(f => {
                f.wallet = 0;
                f.bank = 0;
            });
            renderAll();
            log("ØªÙ… ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø± (Ø§Ù„Ø±ØµÙŠØ¯ ÙˆØ§Ù„Ø¨Ù†Ùƒ)");
        }

        function renderAll() {
            renderFamilies();
            renderSummary();
            renderSelects();
        }

        function renderFamilies() {
            const grid = document.getElementById('familiesGrid');
            grid.innerHTML = "";

            if (families.length === 0) {
                grid.innerHTML = "<p style='text-align:center;color:#bdc3c7;'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ø± Ø¨Ø¹Ø¯. Ø£Ø¶Ù Ø£Ø³Ø±Ø© Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰.</p>";
                return;
            }

            const leaderId = getLeaderId();

            families.forEach((f, index) => {
                const total = f.wallet + f.bank;

                const card = document.createElement('div');
                card.className = "family-card" + (f.id === leaderId ? " leader" : "");

                card.innerHTML = `
                <div class="family-header">
                    <div class="family-name">${f.name}</div>
                    <div class="family-rank">#${index + 1}</div>
                </div>
                <div class="points-row">
                    <span class="label">Ø§Ù„Ù…Ø­ÙØ¸Ø©:</span>
                    <span class="value">${f.wallet}</span>
                </div>
                <div class="points-row">
                    <span class="label">Ø§Ù„Ø¨Ù†Ùƒ:</span>
                    <span class="value">${f.bank}</span>
                </div>
                <div class="points-row">
                    <span class="label">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span>
                    <span class="value">${total}</span>
                </div>
                <div class="family-buttons">
                    <button class="btn-green" onclick="doubleWallet(${f.id})">Ã—2</button>
                    <button class="btn-purple" onclick="addToWallet(${f.id}, 100)">+100</button>
                    <button class="btn-dark" onclick="addToWallet(${f.id}, -100)">-100</button>
                    <button class="btn-blue" onclick="depositHalfToBank(${f.id})">Ù†ØµÙ Ù„Ù„Ø¨Ù†Ùƒ</button>
                    <button class="btn-main" onclick="editFamilyName(${f.id})">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù…</button>
                    <button class="btn-red" onclick="deleteFamily(${f.id})">Ø­Ø°Ù Ø§Ù„Ø£Ø³Ø±Ø©</button>
                </div>
            `;

                grid.appendChild(card);
            });
        }

        function renderSummary() {
            const bar = document.getElementById('summaryBar');
            bar.innerHTML = "";

            const familiesCount = families.length;
            const totalPoints = families.reduce((sum, f) => sum + f.wallet + f.bank, 0);
            const leader = getLeader();

            const pill1 = document.createElement('div');
            pill1.className = "top-pill";
            pill1.textContent = `Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø±: ${familiesCount}`;
            bar.appendChild(pill1);

            const pill2 = document.createElement('div');
            pill2.className = "top-pill";
            pill2.textContent = `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‚Ø§Ø· ÙÙŠ Ø§Ù„Ù„Ø¹Ø¨Ø©: ${totalPoints}`;
            bar.appendChild(pill2);

            if (leader) {
                const pill3 = document.createElement('div');
                pill3.className = "top-pill";
                pill3.textContent = `Ø§Ù„Ù…ØªØµØ¯Ø±: ${leader.name} (${leader.wallet + leader.bank} Ù†Ù‚Ø·Ø©)`;
                bar.appendChild(pill3);
            }
        }

        function renderSelects() {
            const selectsIds = [
                'targetFamilySelect1',
                'targetFamilySelect2',
                'targetFamilySelect3',
                'fromFamilySelect',
                'toFamilySelect',
                'bankFamilySelect'
            ];
            selectsIds.forEach(id => {
                const sel = document.getElementById(id);
                sel.innerHTML = "";
                families.forEach(f => {
                    const opt = document.createElement('option');
                    opt.value = f.id;
                    opt.textContent = f.name;
                    sel.appendChild(opt);
                });
            });
        }

        function getLeader() {
            if (families.length === 0) return null;
            let sorted = [...families].sort((a, b) => (b.wallet + b.bank) - (a.wallet + a.bank));
            return sorted[0];
        }
        function getLeaderId() {
            const leader = getLeader();
            return leader ? leader.id : null;
        }

        function findFamily(id) {
            return families.find(f => f.id === id);
        }

        function addToWallet(id, amount) {
            const f = findFamily(id);
            if (!f) return;
            let newVal = f.wallet + amount;
            if (newVal < 0) newVal = 0;
            f.wallet = newVal;
            renderAll();
            if (amount > 0) {
                log(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${amount} Ù†Ù‚Ø·Ø© Ø¥Ù„Ù‰ Â«${f.name}Â» (Ø§Ù„Ù…Ø­ÙØ¸Ø©)`);
            } else if (amount < 0) {
                log(`ØªÙ… Ø®ØµÙ… ${Math.abs(amount)} Ù†Ù‚Ø·Ø© Ù…Ù† Â«${f.name}Â» (Ø§Ù„Ù…Ø­ÙØ¸Ø©)`);
            }
        }

        function doubleWallet(id) {
            const f = findFamily(id);
            if (!f) return;
            f.wallet = f.wallet * 2;
            renderAll();
            log(`ØªÙ… ØªØ¶Ø¹ÙŠÙ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø£Ø³Ø±Ø© Â«${f.name}Â» Ø¥Ù„Ù‰ ${f.wallet} Ù†Ù‚Ø·Ø© (Ã—2)`);
        }

        function depositHalfToBank(id) {
            const f = findFamily(id);
            if (!f) return;
            const half = Math.floor(f.wallet / 2);
            f.wallet -= half;
            f.bank += half;
            renderAll();
            log(`ØªÙ… ØªØ­ÙˆÙŠÙ„ Ù†ØµÙ Ø§Ù„Ù…Ø­ÙØ¸Ø© (${half} Ù†Ù‚Ø·Ø©) Ø¥Ù„Ù‰ Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø±Ø© Â«${f.name}Â»`);
        }

        function editFamilyName(id) {
            const f = findFamily(id);
            if (!f) return;
            const newName = prompt("Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø£Ø³Ø±Ø©:", f.name);
            if (newName && newName.trim()) {
                log(`ØªÙ… ØªØºÙŠÙŠØ± Ø§Ø³Ù… Ø§Ù„Ø£Ø³Ø±Ø© Ù…Ù† Â«${f.name}Â» Ø¥Ù„Ù‰ Â«${newName.trim()}Â»`);
                f.name = newName.trim();
                renderAll();
            }
        }

        function deleteFamily(id) {
            const f = findFamily(id);
            if (!f) return;
            if (!confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ø£Ø³Ø±Ø© Â«${f.name}Â»ØŸ`)) return;
            families = families.filter(x => x.id !== id);
            renderAll();
            log(`ØªÙ… Ø­Ø°Ù Ø§Ù„Ø£Ø³Ø±Ø© Â«${f.name}Â» Ù…Ù† Ø§Ù„Ù„Ø¹Ø¨Ø©`);
        }

        function zeroWallet() {
            const sel = document.getElementById('targetFamilySelect1');
            const id = Number(sel.value);
            const f = findFamily(id);
            if (!f) return;
            if (!confirm(`ØªØ£ÙƒÙŠØ¯: ØªØµÙÙŠØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© ÙÙ‚Ø· Ù„Ù„Ø£Ø³Ø±Ø© Â«${f.name}Â»ØŸ`)) return;
            f.wallet = 0;
            renderAll();
            log(`Ø¨ÙŠÙ†ÙŠØ©: ØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø£Ø³Ø±Ø© Â«${f.name}Â»`);
        }

        function zeroAll() {
            const sel = document.getElementById('targetFamilySelect2');
            const id = Number(sel.value);
            const f = findFamily(id);
            if (!f) return;
            if (!confirm(`ØªØ£ÙƒÙŠØ¯: ØªØµÙÙŠØ± Ø§Ù„Ø£Ø³Ø±Ø© Â«${f.name}Â» Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ (Ù…Ø­ÙØ¸Ø© + Ø¨Ù†Ùƒ)ØŸ`)) return;
            f.wallet = 0;
            f.bank = 0;
            renderAll();
            log(`Ø¨ÙŠÙ†ÙŠØ© Ù‚ÙˆÙŠØ©: ØªÙ… ØªØµÙÙŠØ± Â«${f.name}Â» Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ ğŸ˜±`);
        }

        function quadrupleWallet() {
            const sel = document.getElementById('targetFamilySelect3');
            const id = Number(sel.value);
            const f = findFamily(id);
            if (!f) return;
            if (!confirm(`ØªØ£ÙƒÙŠØ¯: ØªØ¶Ø¹ÙŠÙ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø£Ø³Ø±Ø© Â«${f.name}Â» Ø£Ø±Ø¨Ø¹ Ù…Ø±Ø§ØªØŸ (Ã—4)`)) return;
            f.wallet = f.wallet * 4;
            renderAll();
            log(`Ø¨ÙŠÙ†ÙŠØ© Ø­Ù…Ø§Ø³ÙŠØ©: ØªÙ… ØªØ¶Ø¹ÙŠÙ Ù…Ø­ÙØ¸Ø© Â«${f.name}Â» Ã—4 Ù„ØªØµØ¨Ø­ ${f.wallet} Ù†Ù‚Ø·Ø© ğŸ”¥`);
        }

        function transferPoints() {
            const fromSel = document.getElementById('fromFamilySelect');
            const toSel = document.getElementById('toFamilySelect');
            const amountInput = document.getElementById('transferAmountInput');

            const fromId = Number(fromSel.value);
            const toId = Number(toSel.value);
            let amount = Number(amountInput.value);

            if (!fromId || !toId || fromId === toId) {
                alert("Ø§Ø®ØªØ± Ø£Ø³Ø±Ø© Ù…Ø±Ø³Ù„Ø© ÙˆØ£Ø®Ø±Ù‰ Ù…Ø³ØªÙ‚Ø¨Ù„Ø© (Ù…Ø®ØªÙ„ÙØªÙŠÙ†)");
                return;
            }
            if (!amount || amount <= 0) {
                alert("Ø£Ø¯Ø®Ù„ Ù‚ÙŠÙ…Ø© Ù†Ù‚Ø§Ø· ØµØ­ÙŠØ­Ø© Ù„Ù„Ù†Ù‚Ù„");
                return;
            }

            const fromFam = findFamily(fromId);
            const toFam = findFamily(toId);
            if (!fromFam || !toFam) return;

            if (fromFam.wallet < amount) {
                amount = fromFam.wallet;
            }

            fromFam.wallet -= amount;
            toFam.wallet += amount;

            renderAll();
            log(`Ø¨ÙŠÙ†ÙŠØ©: ØªÙ… Ù†Ù‚Ù„ ${amount} Ù†Ù‚Ø·Ø© Ù…Ù† Â«${fromFam.name}Â» Ø¥Ù„Ù‰ Â«${toFam.name}Â» (Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø© ÙÙ‚Ø·)`);
            amountInput.value = "";
        }

        function depositAllToBank() {
            const sel = document.getElementById('bankFamilySelect');
            const id = Number(sel.value);
            const f = findFamily(id);
            if (!f) return;
            if (f.wallet <= 0) {
                alert("Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø³Ø±Ø© Ù„Ø§ ØªÙ…Ù„Ùƒ Ø±ØµÙŠØ¯Ù‹Ø§ ÙÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ø¥ÙŠØ¯Ø§Ø¹Ù‡");
                return;
            }
            const amt = f.wallet;
            f.wallet = 0;
            f.bank += amt;
            renderAll();
            log(`ØªÙ… Ø¥ÙŠØ¯Ø§Ø¹ ÙƒÙ„ Ø§Ù„Ù…Ø­ÙØ¸Ø© (${amt} Ù†Ù‚Ø·Ø©) ÙÙŠ Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø±Ø© Â«${f.name}Â»`);
        }

        // =====================================
        // Ø§Ù„Ø³Ø¬Ù„
        // =====================================
        function log(text) {
            const box = document.getElementById('historyBox');
            const entry = document.createElement('div');
            entry.className = "history-entry";

            const timeSpan = document.createElement('span');
            timeSpan.className = "time";
            const now = new Date();
            const hh = String(now.getHours()).padStart(2, '0');
            const mm = String(now.getMinutes()).padStart(2, '0');
            timeSpan.textContent = `[${hh}:${mm}]`;

            const msgSpan = document.createElement('span');
            msgSpan.textContent = " " + text;

            entry.appendChild(timeSpan);
            entry.appendChild(msgSpan);
            box.prepend(entry);
        }

        // =====================================
        // Ø§Ù„Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ…Ø²
        // =====================================
        const MINI_GAMES = [
            { id: "memory", label: "1- Ù„Ø¹Ø¨Ø© Ø§Ù„Ø°Ø§ÙƒØ±Ø© (ÙƒØ±ÙˆØª)" },
            { id: "reaction", label: "2- Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±Ø¹Ø© Ø§Ù„ØªÙØ§Ø¹Ù„" },
            { id: "mole", label: "3- Ø§Ø¶Ø±Ø¨ Ø§Ù„Ø®Ù„Ø¯" },
            { id: "guessNumber", label: "4- ØªØ®Ù…ÙŠÙ† Ø§Ù„Ø±Ù‚Ù… (1-100)" },
            { id: "clicker", label: "5- ØªØ­Ø¯ÙŠ Ø§Ù„Ù†Ù‚Ø± Ø§Ù„Ø³Ø±ÙŠØ¹" },
            { id: "oddColor", label: "6- Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ù…Ø®ØªÙ„Ù" },
            { id: "cups", label: "7- Ø§Ù„ÙƒØ£Ø³ ÙˆØ§Ù„ÙƒØ±Ø©" },
            { id: "typing", label: "8- Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±Ø¹Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø©" },
            { id: "rps", label: "9- Ø­Ø¬Ø± - ÙˆØ±Ù‚Ø© - Ù…Ù‚Øµ" },
            { id: "mentalSteps", label: "10- Ø³Ù„Ù… Ø§Ù„Ø£Ø±Ù‚Ø§Ù… (Ø¬Ù…Ø¹/Ø·Ø±Ø­ Ø°Ù‡Ù†ÙŠ)" }
        ];

        function populateMiniGameSelect() {
            const sel = document.getElementById('miniGameSelect');
            sel.innerHTML = "";
            MINI_GAMES.forEach(g => {
                const opt = document.createElement('option');
                opt.value = g.id;
                opt.textContent = g.label;
                sel.appendChild(opt);
            });
        }

        function startSelectedMiniGame() {
            const sel = document.getElementById('miniGameSelect');
            const id = sel.value;
            if (!id) {
                alert("Ø§Ø®ØªØ± Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ… Ø£ÙˆÙ„Ø§Ù‹");
                return;
            }
            openMiniGame(id);
        }

        function startRandomMiniGame() {
            const idx = Math.floor(Math.random() * MINI_GAMES.length);
            openMiniGame(MINI_GAMES[idx].id);
        }

        function openMiniGame(id) {
            const overlay = document.getElementById('miniGameOverlay');
            const titleEl = document.getElementById('miniGameTitle');
            const bodyEl = document.getElementById('miniGameBody');

            const gameInfo = MINI_GAMES.find(g => g.id === id);
            titleEl.textContent = gameInfo ? gameInfo.label : "Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ…";

            bodyEl.innerHTML = ""; // clear

            // Ù†Ø®ØªØ§Ø± Ø§Ù„Ù„Ø¹Ø¨Ø©
            if (id === "memory") {
                initMemoryGame(bodyEl);
            } else if (id === "reaction") {
                initReactionGame(bodyEl);
            } else if (id === "mole") {
                initMoleGame(bodyEl);
            } else if (id === "guessNumber") {
                initGuessNumberGame(bodyEl);
            } else if (id === "clicker") {
                initClickerGame(bodyEl);
            } else if (id === "oddColor") {
                initOddColorGame(bodyEl);
            } else if (id === "cups") {
                initCupsGame(bodyEl);
            } else if (id === "typing") {
                initTypingGame(bodyEl);
            } else if (id === "rps") {
                initRpsGame(bodyEl);
            } else if (id === "mentalSteps") {
                initMentalStepsGame(bodyEl);
            }

            overlay.classList.remove('hidden');
            log(`ØªÙ… ØªØ´ØºÙŠÙ„ Ù…ÙŠÙ†ÙŠ Ù‚ÙŠÙ…: ${titleEl.textContent}`);
        }

        function closeMiniGame() {
            const overlay = document.getElementById('miniGameOverlay');
            overlay.classList.add('hidden');
        }

        // ========== 1) Ù„Ø¹Ø¨Ø© Ø§Ù„Ø°Ø§ÙƒØ±Ø© ==========
        function initMemoryGame(container) {
            const wrapper = document.createElement('div');
            wrapper.innerHTML = `
            <div>Ø§Ø®ØªØ± Ù„Ø§Ø¹Ø¨Ù‹Ø§ Ù…Ù† ÙƒÙ„ Ø£Ø³Ø±Ø©ØŒ ÙˆØ§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ Ù…Ù† ÙŠÙØªØ­ Ø§Ù„Ø£Ø²ÙˆØ§Ø¬ ÙÙŠ Ø£Ù‚Ù„ Ø¹Ø¯Ø¯ Ù…Ø­Ø§ÙˆÙ„Ø§Øª.</div>
            <div style="margin-top:6px;">Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ ÙƒØ±ØªÙŠÙ† Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø·Ø§Ø¨Ù‚ØªÙ‡Ù…Ø§.</div>
            <div id="memoryStats" style="margin-top:6px;">Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª: 0 | Ø§Ù„Ø£Ø²ÙˆØ§Ø¬ Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©: 0 / 4</div>
        `;
            const grid = document.createElement('div');
            grid.className = "memory-grid";

            const symbols = ['ğŸ', 'ğŸ', 'â­', 'â­', 'âš½', 'âš½', 'ğŸ§', 'ğŸ§'];
            // Ø®Ù„Ø·
            for (let i = symbols.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [symbols[i], symbols[j]] = [symbols[j], symbols[i]];
            }

            let firstIndex = null;
            let lock = false;
            let attempts = 0;
            let matched = 0;

            symbols.forEach((sym, idx) => {
                const card = document.createElement('div');
                card.className = "memory-card";
                card.dataset.index = idx;
                card.dataset.symbol = sym;
                card.textContent = "";
                card.addEventListener('click', () => {
                    if (lock) return;
                    if (card.classList.contains('matched') || card.classList.contains('flipped')) return;

                    card.classList.add('flipped');
                    card.textContent = sym;

                    if (firstIndex === null) {
                        firstIndex = idx;
                    } else {
                        lock = true;
                        attempts++;
                        const prevCard = grid.querySelector(`.memory-card[data-index="${firstIndex}"]`);
                        if (prevCard && prevCard.dataset.symbol === sym) {
                            // match
                            setTimeout(() => {
                                card.classList.remove('flipped');
                                prevCard.classList.remove('flipped');
                                card.classList.add('matched');
                                prevCard.classList.add('matched');
                                card.textContent = sym;
                                prevCard.textContent = sym;
                                matched++;
                                updateStats();
                                lock = false;
                                firstIndex = null;
                                if (matched === symbols.length / 2) {
                                    alert("Ø§ÙƒØªÙ…Ù„Øª ÙƒÙ„ Ø§Ù„Ø£Ø²ÙˆØ§Ø¬! Ø­Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø±Ø© Ø§Ù„ÙØ§Ø¦Ø²Ø© ÙˆØ£Ø¶Ù Ù„Ù‡Ø§ Ù†Ù‚Ø§Ø·Ù‹Ø§.");
                                }
                            }, 400);
                        } else {
                            // not match
                            setTimeout(() => {
                                card.classList.remove('flipped');
                                prevCard.classList.remove('flipped');
                                card.textContent = "";
                                prevCard.textContent = "";
                                updateStats();
                                lock = false;
                                firstIndex = null;
                            }, 600);
                        }
                    }
                });
                grid.appendChild(card);
            });

            function updateStats() {
                const stats = wrapper.querySelector('#memoryStats');
                stats.textContent = `Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª: ${attempts} | Ø§Ù„Ø£Ø²ÙˆØ§Ø¬ Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©: ${matched} / 4`;
            }

            container.appendChild(wrapper);
            container.appendChild(grid);
        }

        // ========== 2) Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±Ø¹Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ ==========
        function initReactionGame(container) {
            const box = document.createElement('div');
            box.className = "reaction-box";
            box.innerHTML = `
            <div>ÙŠØ´Ø§Ø±Ùƒ Ù…Ù…Ø«Ù„ Ù…Ù† ÙƒÙ„ Ø£Ø³Ø±Ø© Ø¨Ø§Ù„ØªÙ†Ø§ÙˆØ¨ Ø£Ùˆ ÙÙŠ ÙƒÙ„ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ØŒ ÙˆØ§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ Ø§Ù„Ø£Ø³Ø±Ø¹ ÙÙŠ Ø§Ù„Ø¶ØºØ· Ø¨Ø¹Ø¯ ØªØºÙŠÙ‘Ø± Ø§Ù„Ù„ÙˆÙ†.</div>
            <div style="margin-top:6px;">Ø§Ø¶ØºØ· "Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±"ØŒ Ø«Ù… Ø§Ù†ØªØ¸Ø± Ø­ØªÙ‰ ÙŠØªØºÙŠØ± Ø§Ù„Ù„ÙˆÙ†ØŒ Ø«Ù… Ø§Ø¶ØºØ· Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø¨Ø£Ø³Ø±Ø¹ Ù…Ø§ ÙŠÙ…ÙƒÙ†.</div>
            <button class="btn-main" id="reactionStartBtn">Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
            <div id="reactionStatus" style="margin-top:8px;">Ø§Ù„Ø­Ø§Ù„Ø©: ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
        `;
            const area = document.createElement('div');
            area.className = "reaction-area";
            area.textContent = "Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ø¹Ù†Ø¯Ù…Ø§ ÙŠØªØºÙŠØ± Ø§Ù„Ù„ÙˆÙ†";
            let waiting = false;
            let ready = false;
            let startTime = 0;
            let timeoutId = null;

            const statusEl = box.querySelector('#reactionStatus');
            const startBtn = box.querySelector('#reactionStartBtn');

            startBtn.addEventListener('click', () => {
                if (timeoutId) clearTimeout(timeoutId);
                waiting = true;
                ready = false;
                area.style.background = "#1e2a52";
                statusEl.textContent = "Ø§Ù„Ø­Ø§Ù„Ø©: Ø§Ù†ØªØ¸Ø± Ø§Ù„ØªØºÙŠÙ‘Ø±...";
                const delay = 1000 + Math.random() * 3000;
                timeoutId = setTimeout(() => {
                    waiting = false;
                    ready = true;
                    area.style.background = "#27ae60";
                    statusEl.textContent = "Ø§Ù„Ø­Ø§Ù„Ø©: Ø§Ø¶ØºØ· Ø§Ù„Ø¢Ù†!";
                    startTime = performance.now();
                }, delay);
            });

            area.addEventListener('click', () => {
                if (waiting) {
                    statusEl.textContent = "Ø¶ØºØ·Øª Ø¨Ø¯Ø±ÙŠ! Ø£Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©.";
                    if (timeoutId) clearTimeout(timeoutId);
                    waiting = false;
                    ready = false;
                    area.style.background = "#e74c3c";
                } else if (ready) {
                    const end = performance.now();
                    const diff = Math.round(end - startTime);
                    statusEl.textContent = `Ø²Ù…Ù† Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©: ${diff} Ù…Ù„Ù„ÙŠ Ø«Ø§Ù†ÙŠØ©.`;
                    ready = false;
                    area.style.background = "#1e2a52";
                    alert("Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø²Ù…Ù† Ù„Ù„Ø£Ø³Ø±Ø©ØŒ ÙˆÙ‚Ø§Ø±Ù† Ø¨ÙŠÙ†Ù‡Ø§ Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ø³Ø±Ø¹.");
                }
            });

            container.appendChild(box);
            container.appendChild(area);
        }

        // ========== 3) Ø§Ø¶Ø±Ø¨ Ø§Ù„Ø®Ù„Ø¯ ==========
        function initMoleGame(container) {
            const info = document.createElement('div');
            info.innerHTML = `
            <div>ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù„Ø¹Ø¨Ø©: ÙƒÙ„ Ù…Ø±Ø© ÙŠØ¸Ù‡Ø± ğŸ¹ ÙÙŠ Ù…Ø±Ø¨Ø¹ØŒ Ø§Ø¶ØºØ· Ø¹Ù„ÙŠÙ‡ Ø¨Ø³Ø±Ø¹Ø©. Ù„Ø¯ÙŠÙƒ 20 Ø«Ø§Ù†ÙŠØ©.</div>
            <div>Ø§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ Ù…Ù† ÙŠØ­ØµÙ„ Ø¹Ù„Ù‰ Ø£Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø¶Ø±Ø¨Ø§Øª ØµØ­ÙŠØ­Ø©.</div>
            <button class="btn-main" id="moleStartBtn">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <div id="moleStatus" style="margin-top:6px;">Ø§Ù„Ù†Ù‚Ø§Ø·: 0 | Ø§Ù„ÙˆÙ‚Øª: -</div>
        `;
            const grid = document.createElement('div');
            grid.className = "mole-grid";

            for (let i = 0; i < 9; i++) {
                const cell = document.createElement('div');
                cell.className = "mole-cell";
                cell.dataset.index = i;
                cell.textContent = "";
                grid.appendChild(cell);
            }

            let score = 0;
            let timeLeft = 0;
            let moleIndex = -1;
            let intervalId = null;
            let timerId = null;

            const statusEl = info.querySelector('#moleStatus');
            const startBtn = info.querySelector('#moleStartBtn');

            function setMole(newIndex) {
                const cells = grid.querySelectorAll('.mole-cell');
                cells.forEach(c => {
                    c.classList.remove('mole');
                    c.textContent = "";
                });
                if (newIndex >= 0) {
                    const target = grid.querySelector(`.mole-cell[data-index="${newIndex}"]`);
                    if (target) {
                        target.classList.add('mole');
                        target.textContent = "ğŸ¹";
                    }
                }
            }

            grid.addEventListener('click', (e) => {
                const cell = e.target.closest('.mole-cell');
                if (!cell) return;
                if (cell.classList.contains('mole')) {
                    score++;
                    setMole(-1);
                    statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                }
            });

            startBtn.addEventListener('click', () => {
                // Ø¥Ø¹Ø§Ø¯Ø©
                score = 0;
                timeLeft = 20;
                statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                setMole(-1);
                if (intervalId) clearInterval(intervalId);
                if (timerId) clearInterval(timerId);

                intervalId = setInterval(() => {
                    const idx = Math.floor(Math.random() * 9);
                    moleIndex = idx;
                    setMole(idx);
                }, 700);

                timerId = setInterval(() => {
                    timeLeft--;
                    statusEl.textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                    if (timeLeft <= 0) {
                        clearInterval(intervalId);
                        clearInterval(timerId);
                        setMole(-1);
                        alert(`Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}. Ø§Ø®ØªØ± Ø§Ù„Ø£Ø³Ø±Ø© Ø§Ù„ÙØ§Ø¦Ø²Ø© Ø­Ø³Ø¨ Ø£Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø©.`);
                    }
                }, 1000);
            });

            container.appendChild(info);
            container.appendChild(grid);
        }

        // ========== 4) ØªØ®Ù…ÙŠÙ† Ø§Ù„Ø±Ù‚Ù… ==========
        function initGuessNumberGame(container) {
            const secret = Math.floor(Math.random() * 100) + 1;
            let attempts = 0;

            const box = document.createElement('div');
            box.innerHTML = `
            <div>Ø§Ù„Ø­Ø§Ø³ÙˆØ¨ Ø§Ø®ØªØ§Ø± Ø±Ù‚Ù… Ø¨ÙŠÙ† 1 Ùˆ 100. Ø§Ù„Ø£Ø³Ø± ØªØªÙ†Ø§ÙˆØ¨ Ø¹Ù„Ù‰ Ø§Ù„ØªØ®Ù…ÙŠÙ†.</div>
            <div>Ù…Ù† ÙŠØ¬Ø¯ Ø§Ù„Ø±Ù‚Ù… Ø¨Ø£Ù‚Ù„ Ø¹Ø¯Ø¯ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù‡Ùˆ Ø§Ù„ÙØ§Ø¦Ø².</div>
            <div style="margin-top:6px;">
                <input id="guessInput" type="number" placeholder="ØªØ®Ù…ÙŠÙ†Ùƒ Ù‡Ù†Ø§">
                <button class="btn-main" id="guessBtn">ØªØ­Ù‚Ù‚</button>
            </div>
            <div id="guessStatus" style="margin-top:6px;">Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©: Ù„Ù… ØªØ¨Ø¯Ø£ Ø¨Ø¹Ø¯.</div>
        `;
            const guessInput = box.querySelector('#guessInput');
            const guessBtn = box.querySelector('#guessBtn');
            const statusEl = box.querySelector('#guessStatus');

            guessBtn.addEventListener('click', () => {
                const val = Number(guessInput.value);
                if (!val || val < 1 || val > 100) {
                    alert("Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù…Ù‹Ø§ Ø¨ÙŠÙ† 1 Ùˆ 100");
                    return;
                }
                attempts++;
                if (val === secret) {
                    statusEl.textContent = `ØµØ­ÙŠØ­! Ø§Ù„Ø±Ù‚Ù… Ù‡Ùˆ ${secret}. Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª: ${attempts}.`;
                    alert("Ø­Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø±Ø© Ø§Ù„ÙØ§Ø¦Ø²Ø© Ø­Ø³Ø¨ Ù…Ù† Ø§ÙƒØªØ´Ù Ø§Ù„Ø±Ù‚Ù…ØŒ ÙˆØ£Ø¶Ù Ù„Ù‡Ø§ Ù†Ù‚Ø§Ø·Ù‹Ø§.");
                } else if (val < secret) {
                    statusEl.textContent = `Ø£Ø¹Ù„Ù‰ Ù…Ù† ${val} (Ù…Ø­Ø§ÙˆÙ„Ø§Øª: ${attempts}).`;
                } else {
                    statusEl.textContent = `Ø£Ù‚Ù„ Ù…Ù† ${val} (Ù…Ø­Ø§ÙˆÙ„Ø§Øª: ${attempts}).`;
                }
                guessInput.value = "";
            });

            container.appendChild(box);
        }

        // ========== 5) ØªØ­Ø¯ÙŠ Ø§Ù„Ù†Ù‚Ø± Ø§Ù„Ø³Ø±ÙŠØ¹ ==========
        function initClickerGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>Ø§Ø®ØªØ± Ù…Ù…Ø«Ù„Ù‹Ø§ Ù…Ù† ÙƒÙ„ Ø£Ø³Ø±Ø©. ÙƒÙ„ ÙˆØ§Ø­Ø¯ ÙŠØ­Ø§ÙˆÙ„ Ø§Ù„Ù†Ù‚Ø± Ø£ÙƒØ¨Ø± Ø¹Ø¯Ø¯ Ù…Ù…ÙƒÙ† ÙÙŠ 5 Ø«ÙˆØ§Ù†.</div>
            <div style="margin-top:6px;">Ø§Ø¶ØºØ· "Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©" Ø«Ù… Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ø¨Ø£Ù‚ØµÙ‰ Ø³Ø±Ø¹Ø©.</div>
            <button class="btn-main" id="clickerStart">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©</button>
            <div id="clickerInfo" style="margin-top:6px;">Ø§Ù„Ù†Ù‚Ø±Ø§Øª: 0 | Ø§Ù„ÙˆÙ‚Øª: -</div>
            <button class="btn-green" id="clickerBtn" style="margin-top:8px;">Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ø¨Ø³Ø±Ø¹Ø©!</button>
        `;
            const startBtn = box.querySelector('#clickerStart');
            const infoEl = box.querySelector('#clickerInfo');
            const clickBtn = box.querySelector('#clickerBtn');

            let clicks = 0;
            let timeLeft = 0;
            let active = false;
            let timerId = null;

            startBtn.addEventListener('click', () => {
                clicks = 0;
                timeLeft = 5;
                active = true;
                infoEl.textContent = `Ø§Ù„Ù†Ù‚Ø±Ø§Øª: ${clicks} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                if (timerId) clearInterval(timerId);
                timerId = setInterval(() => {
                    timeLeft--;
                    infoEl.textContent = `Ø§Ù„Ù†Ù‚Ø±Ø§Øª: ${clicks} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
                    if (timeLeft <= 0) {
                        active = false;
                        clearInterval(timerId);
                        alert(`Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ù‚Ø±Ø§Øª: ${clicks}. Ø³Ø¬Ù‘Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø£Ø³Ø±Ø©.`);
                    }
                }, 1000);
            });

            clickBtn.addEventListener('click', () => {
                if (!active) return;
                clicks++;
                infoEl.textContent = `Ø§Ù„Ù†Ù‚Ø±Ø§Øª: ${clicks} | Ø§Ù„ÙˆÙ‚Øª: ${timeLeft}`;
            });

            container.appendChild(box);
        }

        // ========== 6) Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ù…Ø®ØªÙ„Ù ==========
        function initOddColorGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>ØªØ¸Ù‡Ø± Ø´Ø¨ÙƒØ© Ù…Ù† Ø§Ù„Ø£Ù„ÙˆØ§Ù†ØŒ ÙˆØ§Ø­Ø¯ Ù…Ù†Ù‡Ø§ Ù…Ø®ØªÙ„Ù Ù‚Ù„ÙŠÙ„Ø§Ù‹. Ù…Ù† Ø£Ø³Ø±Ø¹ Ø£Ø³Ø±Ø© ØªØ¬Ø¯ Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ù…Ø®ØªÙ„Ù ØªÙÙˆØ².</div>
            <div style="margin-top:6px;">ÙƒÙ„ Ø¬ÙˆÙ„Ø©: Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø§Ù„Ù…Ø®ØªÙ„Ù Ø¨Ø£Ø³Ø±Ø¹ Ù…Ø§ ÙŠÙ…ÙƒÙ†.</div>
            <button class="btn-main" id="oddStart">Ø¬ÙˆÙ„Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
            <div id="oddStatus" style="margin-top:6px;">Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¬ÙˆÙ„Ø©.</div>
        `;
            const grid = document.createElement('div');
            grid.className = "color-grid";

            const startBtn = box.querySelector('#oddStart');
            const statusEl = box.querySelector('#oddStatus');

            let oddIndex = -1;
            let clickable = false;

            function newRound() {
                grid.innerHTML = "";
                clickable = true;
                const size = 16;
                const baseHue = Math.floor(Math.random() * 360);
                const baseColor = `hsl(${baseHue}, 60%, 50%)`;
                const oddColor = `hsl(${baseHue}, 60%, 60%)`;
                oddIndex = Math.floor(Math.random() * size);

                for (let i = 0; i < size; i++) {
                    const cell = document.createElement('div');
                    cell.className = "color-cell";
                    cell.style.background = (i === oddIndex) ? oddColor : baseColor;
                    cell.dataset.index = i;
                    grid.appendChild(cell);
                }
                statusEl.textContent = "Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ù…Ø®ØªÙ„Ù!";
            }

            grid.addEventListener('click', (e) => {
                const cell = e.target.closest('.color-cell');
                if (!cell || !clickable) return;
                const idx = Number(cell.dataset.index);
                if (idx === oddIndex) {
                    statusEl.textContent = "ØµØ­ÙŠØ­! Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ù…Ø®ØªÙ„Ù ØªÙ… Ø§Ø®ØªÙŠØ§Ø±Ù‡.";
                    clickable = false;
                    alert("Ø­Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø±Ø© Ø§Ù„Ø£Ø³Ø±Ø¹ØŒ ÙˆØ£Ø¶Ù Ù„Ù‡Ø§ Ù†Ù‚Ø§Ø·Ù‹Ø§.");
                } else {
                    statusEl.textContent = "Ø®Ø·Ø£! Ø¬Ø±Ù‘Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø£Ùˆ Ø£Ø¹Ø·Ù Ø§Ù„ÙØ±ØµØ© Ù„Ø£Ø³Ø±Ø© Ø£Ø®Ø±Ù‰.";
                }
            });

            startBtn.addEventListener('click', newRound);

            container.appendChild(box);
            container.appendChild(grid);
        }

        // ========== 7) Ø§Ù„ÙƒØ£Ø³ ÙˆØ§Ù„ÙƒØ±Ø© ==========
        function initCupsGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>Ø´Ø§Ù‡Ø¯ Ù…ÙƒØ§Ù† Ø§Ù„ÙƒØ±Ø© Ø«Ù… Ø³ÙŠØªÙ… Ø®Ù„Ø· Ø§Ù„Ø£ÙƒÙˆØ§Ø¨. Ø¨Ø¹Ø¯ Ø§Ù„Ø®Ù„Ø· Ø§Ø®ØªØ± Ø§Ù„ÙƒØ£Ø³ Ø§Ù„ØµØ­ÙŠØ­.</div>
            <div>Ø§Ù„Ø£Ø³Ø±Ø© Ø§Ù„ØªÙŠ ØªØ®Ù…Ù‘Ù† Ù…ÙƒØ§Ù† Ø§Ù„ÙƒØ±Ø© Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ ØªÙÙˆØ².</div>
            <button class="btn-main" id="cupsStart">Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙƒØ±Ø© ÙˆØ¨Ø¯Ø¡ Ø§Ù„Ø®Ù„Ø·</button>
            <div id="cupsStatus" style="margin-top:6px;">Ø§Ø¶ØºØ· Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø©.</div>
        `;
            const row = document.createElement('div');
            row.className = "cup-row";

            const cups = [];
            for (let i = 0; i < 3; i++) {
                const cup = document.createElement('div');
                cup.className = "cup";
                cup.dataset.index = i;
                cup.textContent = "ğŸ¥¤";
                row.appendChild(cup);
                cups.push(cup);
            }

            const startBtn = box.querySelector('#cupsStart');
            const statusEl = box.querySelector('#cupsStatus');

            let ballIndex = -1;
            let shuffling = false;
            let guessMode = false;

            function showBall() {
                cups.forEach((cup, idx) => {
                    if (idx === ballIndex) {
                        cup.textContent = "âš½";
                    } else {
                        cup.textContent = "ğŸ¥¤";
                    }
                });
            }

            function hideBall() {
                cups.forEach(cup => {
                    cup.textContent = "ğŸ¥¤";
                });
            }

            function shuffleCups(times) {
                if (times === 0) {
                    shuffling = false;
                    guessMode = true;
                    statusEl.textContent = "Ø§Ø®ØªØ± Ø§Ù„ÙƒØ£Ø³ Ø§Ù„Ø°ÙŠ ØªØ¹ØªÙ‚Ø¯ Ø£Ù† Ø§Ù„ÙƒØ±Ø© ØªØ­ØªÙ‡.";
                    return;
                }
                shuffling = true;
                guessMode = false;
                // ØªØ¨Ø§Ø¯Ù„ Ø¨ÙŠÙ† ÙƒÙˆØ¨ÙŠÙ† Ø¹Ø´ÙˆØ§Ø¦ÙŠÙŠÙ†
                const i = Math.floor(Math.random() * 3);
                let j = Math.floor(Math.random() * 3);
                while (j === i) j = Math.floor(Math.random() * 3);

                // ØªØ¨Ø§Ø¯Ù„ ÙÙŠ DOM
                const cupI = cups[i];
                const cupJ = cups[j];
                const tmp = document.createElement('div');
                row.replaceChild(tmp, cupI);
                row.replaceChild(cupI, cupJ);
                row.replaceChild(cupJ, tmp);

                // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ±ØªÙŠØ¨ ÙÙŠ Ø§Ù„Ù…ØµÙÙˆÙØ©
                cups[i] = cupJ;
                cups[j] = cupI;

                // ØªØ­Ø¯ÙŠØ« ballIndex Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø±ÙƒØ©
                if (ballIndex === i) ballIndex = j;
                else if (ballIndex === j) ballIndex = i;

                setTimeout(() => shuffleCups(times - 1), 400);
            }

            startBtn.addEventListener('click', () => {
                if (shuffling) return;
                // Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ù„Ù…ÙƒØ§Ù† Ø§Ù„ÙƒØ±Ø©
                ballIndex = Math.floor(Math.random() * 3);
                showBall();
                statusEl.textContent = "Ø´Ø§Ù‡ÙØ¯ Ù…ÙƒØ§Ù† Ø§Ù„ÙƒØ±Ø©...";
                setTimeout(() => {
                    hideBall();
                    statusEl.textContent = "ÙŠØªÙ… Ø®Ù„Ø· Ø§Ù„Ø£ÙƒÙˆØ§Ø¨...";
                    shuffleCups(8 + Math.floor(Math.random() * 5));
                }, 1500);
            });

            row.addEventListener('click', (e) => {
                const cup = e.target.closest('.cup');
                if (!cup || !guessMode) return;
                const idx = cups.indexOf(cup);
                if (idx === ballIndex) {
                    showBall();
                    statusEl.textContent = "Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! Ø§Ù„ÙƒØ±Ø© ØªØ­Øª Ù‡Ø°Ø§ Ø§Ù„ÙƒØ£Ø³.";
                    guessMode = false;
                    alert("Ø§Ù…Ù†Ø­ Ù†Ù‚Ø§Ø·Ù‹Ø§ Ù„Ù„Ø£Ø³Ø±Ø© Ø§Ù„ØªÙŠ Ø®Ù…Ù‘Ù†Øª Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.");
                } else {
                    statusEl.textContent = "Ø®Ø·Ø£! Ø§Ù„ÙƒØ±Ø© ÙÙŠ ÙƒØ£Ø³ Ø¢Ø®Ø±.";
                }
            });

            container.appendChild(box);
            container.appendChild(row);
        }

        // ========== 8) Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±Ø¹Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø© ==========
        function initTypingGame(container) {
            const texts = [
                "Ø§Ù„ØªØ¹Ø§ÙˆÙ† Ø³Ø± Ø§Ù„Ù†Ø¬Ø§Ø­ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø³Ø±.",
                "Ø§Ù„ØªØ±ÙƒÙŠØ² ÙˆØ§Ù„Ø³Ø±Ø¹Ø© ÙŠÙ„Ø¹Ø¨Ø§Ù† Ø¯ÙˆØ±Ù‹Ø§ Ù…Ù‡Ù…Ù‹Ø§ ÙÙŠ Ø§Ù„ÙÙˆØ².",
                "Ù…Ù† Ø³ÙŠØ±Ø¨Ø­ Ø§Ù„Ù…Ù„ÙŠÙˆÙ† ÙŠØ¨Ø¯Ø£ Ù…Ù† Ù†Ù‚Ø·Ø© ÙˆØ§Ø­Ø¯Ø©.",
                "Ø§Ù„Ø¨Ø·ÙˆÙ„Ø© ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø­Ù…Ø§Ø³ ÙˆØ¹Ø¯Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø¬Ù…ÙŠØ¹."
            ];
            const targetText = texts[Math.floor(Math.random() * texts.length)];

            const box = document.createElement('div');
            box.className = "typing-box";
            box.innerHTML = `
            <div>Ø§Ø®ØªØ± Ù…Ù…Ø«Ù„Ù‹Ø§ Ù…Ù† ÙƒÙ„ Ø£Ø³Ø±Ø©. Ù…Ù† ÙŠÙƒØªØ¨ Ø§Ù„Ø¬Ù…Ù„Ø© Ø¨Ø£Ø³Ø±Ø¹ ÙˆÙ‚Øª ÙˆØ¨Ø£Ù‚Ù„ Ø£Ø®Ø·Ø§Ø¡ ÙŠÙÙˆØ².</div>
            <div style="margin-top:6px;">Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ÙƒØªØ§Ø¨ØªÙ‡:</div>
            <div style="margin-top:4px;padding:6px;border-radius:6px;background:#050815;border:1px solid #34495e;">
                ${targetText}
            </div>
            <button class="btn-main" id="typingStart">Ø¨Ø¯Ø¡ Ø§Ù„Ù‚ÙŠØ§Ø³</button>
            <div style="margin-top:6px;">Ø§ÙƒØªØ¨ Ù‡Ù†Ø§:</div>
            <textarea id="typingArea" disabled></textarea>
            <div id="typingStatus" style="margin-top:6px;">Ø§Ù„ÙˆÙ‚Øª: - | Ø§Ù„Ø¯Ù‚Ø©: -</div>
        `;
            const startBtn = box.querySelector('#typingStart');
            const textArea = box.querySelector('#typingArea');
            const statusEl = box.querySelector('#typingStatus');

            let startTime = null;
            let finished = false;

            startBtn.addEventListener('click', () => {
                textArea.value = "";
                textArea.disabled = false;
                textArea.focus();
                finished = false;
                startTime = performance.now();
                statusEl.textContent = "Ø§Ù„ÙˆÙ‚Øª: Ø¬Ø§Ø±ÙŠ... | Ø§Ù„Ø¯Ù‚Ø©: -";
            });

            textArea.addEventListener('input', () => {
                if (!startTime || finished) return;
                const current = textArea.value;
                if (current === targetText) {
                    const end = performance.now();
                    finished = true;
                    const timeSec = ((end - startTime) / 1000).toFixed(2);
                    statusEl.textContent = `Ø§Ù„ÙˆÙ‚Øª: ${timeSec} Ø«Ø§Ù†ÙŠØ© | Ø§Ù„Ø¯Ù‚Ø©: 100%`;
                    textArea.disabled = true;
                    alert("Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø²Ù…Ù† Ù„Ù„Ø£Ø³Ø±Ø©ØŒ ÙˆÙ‚Ø§Ø±Ù† Ø¨ÙŠÙ† Ø§Ù„Ø¬Ù…ÙŠØ¹ Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙØ§Ø¦Ø².");
                } else {
                    // ØªÙ‚Ø¯ÙŠØ± Ø§Ù„Ø¯Ù‚Ø© Ù…Ø¨Ø¯Ø¦ÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„ØµØ­ÙŠØ­Ø©
                    let correct = 0;
                    for (let i = 0; i < Math.min(current.length, targetText.length); i++) {
                        if (current[i] === targetText[i]) correct++;
                    }
                    const accuracy = ((correct / targetText.length) * 100).toFixed(0);
                    statusEl.textContent = `Ø§Ù„ÙˆÙ‚Øª: Ø¬Ø§Ø±ÙŠ... | Ø§Ù„Ø¯Ù‚Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠØ©: ${accuracy}%`;
                }
            });

            container.appendChild(box);
        }

        // ========== 9) Ø­Ø¬Ø± - ÙˆØ±Ù‚Ø© - Ù…Ù‚Øµ ==========
        function initRpsGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>ÙŠÙ…ÙƒÙ† Ù„ÙƒÙ„ Ø£Ø³Ø±Ø© Ø§Ø®ØªÙŠØ§Ø± Ù…Ù…Ø«Ù„. Ø§Ù„Ù„Ø¹Ø¨ Ø¶Ø¯ Ø§Ù„Ø­Ø§Ø³ÙˆØ¨ØŒ ÙˆÙŠÙ…ÙƒÙ† ØªØ¯ÙˆÙŠÙ† Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù„ÙƒÙ„ Ø£Ø³Ø±Ø©.</div>
            <div style="margin-top:6px;">Ø§Ø®ØªØ±: Ø­Ø¬Ø± ğŸª¨ Ø£Ùˆ ÙˆØ±Ù‚Ø© ğŸ“„ Ø£Ùˆ Ù…Ù‚Øµ âœ‚ï¸</div>
            <div style="margin-top:8px;">
                <button class="btn-dark" data-move="rock">ğŸª¨ Ø­Ø¬Ø±</button>
                <button class="btn-dark" data-move="paper">ğŸ“„ ÙˆØ±Ù‚Ø©</button>
                <button class="btn-dark" data-move="scissors">âœ‚ï¸ Ù…Ù‚Øµ</button>
            </div>
            <div id="rpsStatus" style="margin-top:8px;">Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§.</div>
        `;
            const statusEl = box.querySelector('#rpsStatus');
            const buttons = box.querySelectorAll('button[data-move]');

            function computerMove() {
                const moves = ["rock", "paper", "scissors"];
                return moves[Math.floor(Math.random() * 3)];
            }
            function result(player, comp) {
                if (player === comp) return "ØªØ¹Ø§Ø¯Ù„";
                if (
                    (player === "rock" && comp === "scissors") ||
                    (player === "paper" && comp === "rock") ||
                    (player === "scissors" && comp === "paper")
                ) return "ÙÙˆØ² Ø§Ù„Ù„Ø§Ø¹Ø¨";
                return "Ø®Ø³Ø§Ø±Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨";
            }

            buttons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const p = btn.dataset.move;
                    const c = computerMove();
                    const res = result(p, c);
                    const toEmoji = (m) => m === "rock" ? "ğŸª¨ Ø­Ø¬Ø±" : (m === "paper" ? "ğŸ“„ ÙˆØ±Ù‚Ø©" : "âœ‚ï¸ Ù…Ù‚Øµ");
                    statusEl.textContent = `Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù„Ø§Ø¹Ø¨: ${toEmoji(p)} | Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø­Ø§Ø³ÙˆØ¨: ${toEmoji(c)} | Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${res}`;
                });
            });

            container.appendChild(box);
        }

        // ========== 10) Ø³Ù„Ù… Ø§Ù„Ø£Ø±Ù‚Ø§Ù… (Ø¬Ù…Ø¹/Ø·Ø±Ø­ Ø°Ù‡Ù†ÙŠ) ==========
        function initMentalStepsGame(container) {
            const box = document.createElement('div');
            box.innerHTML = `
            <div>ØªÙØ¹Ø±Ø¶ Ø³Ù„Ø³Ù„Ø© Ø¹Ù…Ù„ÙŠØ§Øª Ø¬Ù…Ø¹ ÙˆØ·Ø±Ø­. Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø± Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù†Ø§ØªØ¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø°Ù‡Ù†ÙŠÙ‹Ø§.</div>
            <div>Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø³Ù„Ø³Ù„Ø©ØŒ Ø§Ø³Ø£Ù„: "Ù…Ø§ Ø§Ù„Ù†Ø§ØªØ¬ØŸ" ÙˆØ§Ù„ÙØ§Ø¦Ø² Ù…Ù† ÙŠØ¹Ø·ÙŠ Ø§Ù„Ù†Ø§ØªØ¬ Ø§Ù„ØµØ­ÙŠØ­.</div>
            <button class="btn-main" id="msStart">Ø¨Ø¯Ø¡ Ø§Ù„Ø³Ù„Ø³Ù„Ø©</button>
            <div id="msSequence" style="margin-top:8px;"></div>
        `;
            const startBtn = box.querySelector('#msStart');
            const seqEl = box.querySelector('#msSequence');

            startBtn.addEventListener('click', () => {
                seqEl.innerHTML = "";
                let current = Math.floor(Math.random() * 20);
                const steps = [];
                for (let i = 0; i < 6; i++) {
                    const delta = Math.floor(Math.random() * 9) + 1;
                    const op = Math.random() < 0.5 ? "+" : "-";
                    steps.push({ op, delta });
                }

                let idx = 0;
                const baseDiv = document.createElement('div');
                baseDiv.textContent = `Ø§Ø¨Ø¯Ø£ Ù…Ù†: ${current}`;
                seqEl.appendChild(baseDiv);

                const stepDiv = document.createElement('div');
                stepDiv.style.marginTop = "6px";
                seqEl.appendChild(stepDiv);

                const timer = setInterval(() => {
                    if (idx >= steps.length) {
                        clearInterval(timer);
                        const final = steps.reduce((acc, s) => s.op === "+" ? acc + s.delta : acc - s.delta, current);
                        const msg = document.createElement('div');
                        msg.style.marginTop = "8px";
                        msg.textContent = "Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø³Ù„Ø³Ù„Ø©! Ø§Ø³Ø£Ù„ Ø§Ù„Ø£Ø³Ø± Ø¹Ù† Ø§Ù„Ù†Ø§ØªØ¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØŒ Ø«Ù… Ø§Ø¶ØºØ· Ù„Ø¹Ø±Ø¶Ù‡:";
                        const btnShow = document.createElement('button');
                        btnShow.className = "btn-blue";
                        btnShow.textContent = "Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø§ØªØ¬";
                        btnShow.addEventListener('click', () => {
                            alert(`Ø§Ù„Ù†Ø§ØªØ¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù‡Ùˆ: ${final}`);
                        });
                        msg.appendChild(document.createElement('br'));
                        msg.appendChild(btnShow);
                        seqEl.appendChild(msg);
                        return;
                    }
                    const s = steps[idx];
                    stepDiv.textContent += ` ${s.op} ${s.delta}`;
                    idx++;
                }, 1200);
            });

            container.appendChild(box);
        }

        // ØªØ´ØºÙŠÙ„ Ø£ÙˆÙ„ÙŠ
        renderAll();
        populateMiniGameSelect();
    </script>

</body>

</html>